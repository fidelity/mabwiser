

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MABWiser Public API &mdash; MABWiser  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Contributing" href="contributing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> MABWiser
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About Multi-Armed Bandits</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Usage Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MABWiser Public API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-mabwiser.base_mab">base_mab</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mabwiser.mab">mab</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mabwiser.simulator">simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mabwiser.utils">utils</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MABWiser</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>MABWiser Public API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mabwiser-public-api">
<span id="mabwiser-api"></span><h1>MABWiser Public API<a class="headerlink" href="#mabwiser-public-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mabwiser.base_mab">
<span id="base-mab"></span><h2>base_mab<a class="headerlink" href="#module-mabwiser.base_mab" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">FMR LLC</td>
</tr>
<tr class="field-even field"><th class="field-name">Email:</th><td class="field-body"><a class="reference external" href="mailto:mabwiser&#37;&#52;&#48;fmr&#46;com">mabwiser<span>&#64;</span>fmr<span>&#46;</span>com</a></td>
</tr>
</tbody>
</table>
<p>This module defines the abstract base class for contextual multi-armed bandit algorithms.</p>
<dl class="class">
<dt id="mabwiser.base_mab.BaseMAB">
<em class="property">class </em><code class="descclassname">mabwiser.base_mab.</code><code class="descname">BaseMAB</code><span class="sig-paren">(</span><em>rng: mtrand.RandomState, arms: List[NewType.&lt;locals&gt;.new_type], n_jobs: int, backend: str = None</em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for multi-armed bandits.</p>
<p>This module is not intended to be used directly, instead it declares
the basic skeleton of multi-armed bandits together with a set of parameters
that are common to every bandit algorithm.</p>
<p>It declares abstract methods that sub-classes can override to
implement specific bandit policies using:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">__init__</span></code> constructor to initialize the bandit</li>
<li><code class="docutils literal notranslate"><span class="pre">add_arm</span></code> method to add a new arm</li>
<li><code class="docutils literal notranslate"><span class="pre">fit</span></code> method for training</li>
<li><code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> method for _online learning</li>
<li><code class="docutils literal notranslate"><span class="pre">predict_expectations</span></code> method to retrieve the expectation of each arm</li>
<li><code class="docutils literal notranslate"><span class="pre">predict</span></code> method for testing to retrieve the best arm based on the policy</li>
</ul>
</div></blockquote>
<dl class="attribute">
<dt id="mabwiser.base_mab.BaseMAB.rng">
<code class="descname">rng</code><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.rng" title="Permalink to this definition">¶</a></dt>
<dd><p>The random number generator.</p>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.base_mab.BaseMAB.arms">
<code class="descname">arms</code><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.arms" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of all arms.</p>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.base_mab.BaseMAB.n_jobs">
<code class="descname">n_jobs</code><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.n_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used to specify how many concurrent processes/threads should be used for parallelized routines.
Default value is set to 1.
If set to -1, all CPUs are used.
If set to -2, all CPUs but one are used, and so on.</p>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.base_mab.BaseMAB.backend">
<code class="descname">backend</code><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.backend" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify a parallelization backend implementation supported in the joblib library. Supported options are:
- “loky” used by default, can induce some communication and memory overhead when exchanging input and</p>
<blockquote>
<div>output data with the worker Python processes.</div></blockquote>
<ul class="simple">
<li>“multiprocessing” previous process-based backend based on multiprocessing.Pool. Less robust than loky.</li>
<li>“threading” is a very low-overhead backend but it suffers from the Python Global Interpreter Lock if the
called function relies a lot on Python objects.</li>
</ul>
<p>Default value is None. In this case the default backend selected by joblib will be used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str, optional</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.base_mab.BaseMAB.arm_to_expectation">
<code class="descname">arm_to_expectation</code><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.arm_to_expectation" title="Permalink to this definition">¶</a></dt>
<dd><p>The dictionary of arms (keys) to their expected rewards (values).</p>
</dd></dl>

<dl class="method">
<dt id="mabwiser.base_mab.BaseMAB.add_arm">
<code class="descname">add_arm</code><span class="sig-paren">(</span><em>arm: NewType.&lt;locals&gt;.new_type</em>, <em>binarizer: Callable = None</em>, <em>scaler: Callable = None</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.base_mab.BaseMAB.add_arm" title="Permalink to this definition">¶</a></dt>
<dd><p>Introduces a new arm to the bandit.</p>
<p>Adds the new arm with zero expectations and
calls the <code class="docutils literal notranslate"><span class="pre">_uptake_new_arm()</span></code> function of the sub-class.</p>
</dd></dl>

<dl class="method">
<dt id="mabwiser.base_mab.BaseMAB.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>decisions: numpy.ndarray</em>, <em>rewards: numpy.ndarray</em>, <em>contexts: Optional[numpy.ndarray] = None</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.base_mab.BaseMAB.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method.</p>
<p>Fits the multi-armed bandit to the given
decision and reward history and corresponding contexts if any.</p>
</dd></dl>

<dl class="method">
<dt id="mabwiser.base_mab.BaseMAB.partial_fit">
<code class="descname">partial_fit</code><span class="sig-paren">(</span><em>decisions: numpy.ndarray</em>, <em>rewards: numpy.ndarray</em>, <em>contexts: Optional[numpy.ndarray] = None</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.base_mab.BaseMAB.partial_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method.</p>
<p>Updates the multi-armed bandit with the given
decision and reward history and corresponding contexts if any.</p>
</dd></dl>

<dl class="method">
<dt id="mabwiser.base_mab.BaseMAB.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>contexts: Optional[numpy.ndarray] = None</em><span class="sig-paren">)</span> &#x2192; NewType.&lt;locals&gt;.new_type<a class="headerlink" href="#mabwiser.base_mab.BaseMAB.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method.</p>
<p>Returns the predicted arm.</p>
</dd></dl>

<dl class="method">
<dt id="mabwiser.base_mab.BaseMAB.predict_expectations">
<code class="descname">predict_expectations</code><span class="sig-paren">(</span><em>contexts: Optional[numpy.ndarray] = None</em><span class="sig-paren">)</span> &#x2192; Dict[NewType.&lt;locals&gt;.new_type, Union[int, float]]<a class="headerlink" href="#mabwiser.base_mab.BaseMAB.predict_expectations" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method.</p>
<p>Returns a dictionary from arms (keys) to their expected rewards (values).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mabwiser.mab">
<span id="mab"></span><h2>mab<a class="headerlink" href="#module-mabwiser.mab" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">FMR LLC</td>
</tr>
<tr class="field-even field"><th class="field-name">Email:</th><td class="field-body"><a class="reference external" href="mailto:mabwiser&#37;&#52;&#48;fmr&#46;com">mabwiser<span>&#64;</span>fmr<span>&#46;</span>com</a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Version:</th><td class="field-body">1.8.0 of January 21, 2020</td>
</tr>
</tbody>
</table>
<p>This module defines the public interface of the <strong>MABWiser Library</strong> providing access to the following modules:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">MAB</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">LearningPolicy</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">NeighborhoodPolicy</span></code></li>
</ul>
</div></blockquote>
<dl class="class">
<dt id="mabwiser.mab.LearningPolicy">
<em class="property">class </em><code class="descclassname">mabwiser.mab.</code><code class="descname">LearningPolicy</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="class">
<dt id="mabwiser.mab.LearningPolicy.EpsilonGreedy">
<em class="property">class </em><code class="descname">EpsilonGreedy</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.EpsilonGreedy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Epsilon Greedy Learning Policy.</p>
<p>This policy selects the arm with the highest expected reward with probability 1 - <span class="math notranslate nohighlight">\(\epsilon\)</span>,
and with probability <span class="math notranslate nohighlight">\(\epsilon\)</span> it selects an arm at random for exploration.</p>
<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.EpsilonGreedy.epsilon">
<code class="descname">epsilon</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.EpsilonGreedy.epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>The probability of selecting a random arm for exploration.
Integer or float. Must be between 0 and 1.
Default value is 0.05.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Num</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm1&#39;</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">epsilon</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.LearningPolicy.LinTS">
<em class="property">class </em><code class="descname">LinTS</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinTS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>LinTS Learning Policy</p>
<p>For each arm LinTS trains a ridge regression and
creates a multivariate normal distribution for the coefficients using the
calculated coefficients as the mean and the covariance as:</p>
<div class="math notranslate nohighlight">
\[\alpha^{2} (x_i^{T}x_i + \lambda * I_d)^{-1}\]</div>
<p>The normal distribution is randomly sampled to obtain
expected coefficients for the ridge regression for each
prediction.</p>
<p><span class="math notranslate nohighlight">\(\alpha\)</span> is a factor used to adjust how conservative the estimate is.
Higher <span class="math notranslate nohighlight">\(\alpha\)</span> values promote more exploration.</p>
<p>The multivariate normal distribution uses Cholesky decomposition to guarantee deterministic behavior.
This method requires that the covariance is a positive definite matrix.
To ensure this is the case, alpha and l2_lambda are required to be greater than zero.</p>
<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.LinTS.alpha">
<code class="descname">alpha</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinTS.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>The multiplier to determine the degree of exploration.
Integer or float. Must be greater than zero.
Default value is 1.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Num</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.LinTS.l2_lambda">
<code class="descname">l2_lambda</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinTS.l2_lambda" title="Permalink to this definition">¶</a></dt>
<dd><p>The regularization strength.
Integer or float. Must be greater than zero.
Default value is 1.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Num</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.LinTS.arm_to_scaler">
<code class="descname">arm_to_scaler</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinTS.arm_to_scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>Standardize context features by arm.
Dictionary mapping each arm to a scaler object. It is assumed
that the scaler objects are already fit and will only be used
to transform context features.
Default value is None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Dict[Arm, Callable]</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">LinTS</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">alpha</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">arm_to_scaler</code></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">l2_lambda</code></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.LearningPolicy.LinUCB">
<em class="property">class </em><code class="descname">LinUCB</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinUCB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>LinUCB Learning Policy.</p>
<p>This policy trains a ridge regression for each arm.
Then, given a given context, it predicts a regression value
and calculates the upper confidence bound of that prediction.
The arm with the highest highest upper bound is selected.</p>
<p>The UCB for each arm is calculated as:</p>
<div class="math notranslate nohighlight">
\[UCB = x_i \beta + \alpha \sqrt{(x_i^{T}x_i + \lambda * I_d)^{-1}x_i}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\beta\)</span> is the matrix of the ridge regression coefficients, <span class="math notranslate nohighlight">\(\lambda\)</span> is the regularization
strength, and I_d is a dxd identity matrix where d is the number of features in the context data.</p>
<p><span class="math notranslate nohighlight">\(\alpha\)</span> is a factor used to adjust how conservative the estimate is.
Higher <span class="math notranslate nohighlight">\(\alpha\)</span> values promote more exploration.</p>
<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.LinUCB.alpha">
<code class="descname">alpha</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinUCB.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>The parameter to control the exploration.
Integer or float. Cannot be negative.
Default value is 1.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Num</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.LinUCB.l2_lambda">
<code class="descname">l2_lambda</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinUCB.l2_lambda" title="Permalink to this definition">¶</a></dt>
<dd><p>The regularization strength.
Integer or float. Cannot be negative.
Default value is 1.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Num</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.LinUCB.arm_to_scaler">
<code class="descname">arm_to_scaler</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinUCB.arm_to_scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>Standardize context features by arm.
Dictionary mapping each arm to a scaler object. It is assumed
that the scaler objects are already fit and will only be used
to transform context features.
Default value is None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Dict[Arm, Callable]</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">LinUCB</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.25</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">alpha</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">arm_to_scaler</code></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">l2_lambda</code></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.LearningPolicy.Random">
<em class="property">class </em><code class="descname">Random</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.Random" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Random Learning Policy.</p>
<p>Returns a random arm for each prediction.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">Random</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.LearningPolicy.Softmax">
<em class="property">class </em><code class="descname">Softmax</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.Softmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Softmax Learning Policy.</p>
<p>This policy selects each arm with a probability proportionate to its average reward.
The average reward is calculated as a logistic function with each probability as:</p>
<div class="math notranslate nohighlight">
\[P(arm) = \frac{ e ^  \frac{\mu_i - \max{\mu}}{ \tau } }
{ \Sigma{e ^  \frac{\mu - \max{\mu}}{ \tau }}  }\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_i\)</span> is the mean for that arm and <span class="math notranslate nohighlight">\(\tau\)</span> is the “temperature” to determine the degree of
exploration.</p>
<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.Softmax.tau">
<code class="descname">tau</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.Softmax.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>The temperature to control the exploration.
Integer or float. Must be greater than zero.
Default value is 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Num</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">tau</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.LearningPolicy.ThompsonSampling">
<em class="property">class </em><code class="descname">ThompsonSampling</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.ThompsonSampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Thompson Sampling Learning Policy.</p>
<p>This policy creates a beta distribution for each arm and
then randomly samples from these distributions.
The arm with the highest sample value is selected.</p>
<p>Notice that rewards must be binary to create beta distributions.
If rewards are not binary, see the <code class="docutils literal notranslate"><span class="pre">binarizer</span></code> function.</p>
<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.ThompsonSampling.binarizer">
<code class="descname">binarizer</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.ThompsonSampling.binarizer" title="Permalink to this definition">¶</a></dt>
<dd><p>If rewards are not binary, a binarizer function is required.
Given an arm decision and its corresponding reward, the binarizer function
returns <cite>True/False</cite> or <cite>0/1</cite> to denote whether the decision counts
as a success, i.e., <cite>True/1</cite> based on the reward or <cite>False/0</cite> otherwise.</p>
<p>The function signature of the binarizer is:</p>
<p><code class="docutils literal notranslate"><span class="pre">binarize(arm:</span> <span class="pre">Arm,</span> <span class="pre">reward:</span> <span class="pre">Num)</span> <span class="pre">-&gt;</span> <span class="pre">True/False</span> <span class="pre">or</span> <span class="pre">0/1</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Callable</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">ThompsonSampling</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arm_to_threshold</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm1&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">binarize</span><span class="p">(</span><span class="n">arm</span><span class="p">,</span> <span class="n">reward</span><span class="p">):</span> <span class="k">return</span> <span class="n">reward</span> <span class="o">&gt;</span> <span class="n">arm_to_threshold</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">ThompsonSampling</span><span class="p">(</span><span class="n">binarizer</span><span class="o">=</span><span class="n">binarize</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">binarizer</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.LearningPolicy.UCB1">
<em class="property">class </em><code class="descname">UCB1</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.UCB1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Upper Confidence Bound1 Learning Policy.</p>
<p>This policy calculates an upper confidence bound for the mean reward of each arm.
It greedily selects the arm with the highest upper confidence bound.</p>
<p>The UCB for each arm is calculated as:</p>
<div class="math notranslate nohighlight">
\[UCB = \mu_i + \alpha \times \sqrt[]{\frac{2 \times log(N)}{n_i}}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mu_i\)</span> is the mean for that arm,
<span class="math notranslate nohighlight">\(N\)</span> is the total number of trials, and
<span class="math notranslate nohighlight">\(n_i\)</span> is the number of times the arm has been selected.</p>
<p><span class="math notranslate nohighlight">\(\alpha\)</span> is a factor used to adjust how conservative the estimate is.
Higher <span class="math notranslate nohighlight">\(\alpha\)</span> values promote more exploration.</p>
<dl class="attribute">
<dt id="mabwiser.mab.LearningPolicy.UCB1.alpha">
<code class="descname">alpha</code><a class="headerlink" href="#mabwiser.mab.LearningPolicy.UCB1.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>The parameter to control the exploration.
Integer of float. Cannot be negative.
Default value is 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Num</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">UCB1</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.25</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">alpha</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.MAB">
<em class="property">class </em><code class="descclassname">mabwiser.mab.</code><code class="descname">MAB</code><span class="sig-paren">(</span><em>arms: List[NewType.&lt;locals&gt;.new_type], learning_policy: Union[mabwiser.mab.EpsilonGreedy, mabwiser.mab.Random, mabwiser.mab.Softmax, mabwiser.mab.ThompsonSampling, mabwiser.mab.UCB1, mabwiser.mab.LinTS, mabwiser.mab.LinUCB], neighborhood_policy: Union[None, mabwiser.mab.Clusters, mabwiser.mab.KNearest, mabwiser.mab.Radius] = None, seed: int = 123456, n_jobs: int = 1, backend: str = None</em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.MAB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p><strong>MABWiser: Contextual Multi-Armed Bandit Library</strong></p>
<p>MABWiser is a research library for fast prototyping of multi-armed bandit algorithms.
It supports <strong>context-free</strong>, <strong>parametric</strong> and <strong>non-parametric</strong> <strong>contextual</strong> bandit models.</p>
<dl class="attribute">
<dt id="mabwiser.mab.MAB.arms">
<code class="descname">arms</code><a class="headerlink" href="#mabwiser.mab.MAB.arms" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of all of the arms available for decisions. Arms can be integers, strings, etc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.MAB.learning_policy">
<code class="descname">learning_policy</code><a class="headerlink" href="#mabwiser.mab.MAB.learning_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>The learning policy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#mabwiser.mab.LearningPolicy" title="mabwiser.mab.LearningPolicy">LearningPolicy</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.MAB.neighborhood_policy">
<code class="descname">neighborhood_policy</code><a class="headerlink" href="#mabwiser.mab.MAB.neighborhood_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>The neighborhood policy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#mabwiser.mab.NeighborhoodPolicy" title="mabwiser.mab.NeighborhoodPolicy">NeighborhoodPolicy</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.MAB.is_contextual">
<code class="descname">is_contextual</code><a class="headerlink" href="#mabwiser.mab.MAB.is_contextual" title="Permalink to this definition">¶</a></dt>
<dd><p>True if contextual policy is given, false otherwise. This is a read-only data field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.MAB.seed">
<code class="descname">seed</code><a class="headerlink" href="#mabwiser.mab.MAB.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>The random seed to initialize the internal random number generator. This is a read-only data field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">numbers.Rational</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.MAB.n_jobs">
<code class="descname">n_jobs</code><a class="headerlink" href="#mabwiser.mab.MAB.n_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used to specify how many concurrent processes/threads should be used for parallelized routines.
Default value is set to 1.
If set to -1, all CPUs are used.
If set to -2, all CPUs but one are used, and so on.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.MAB.backend">
<code class="descname">backend</code><a class="headerlink" href="#mabwiser.mab.MAB.backend" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify a parallelization backend implementation supported in the joblib library. Supported options are:
- “loky” used by default, can induce some communication and memory overhead when exchanging input and</p>
<blockquote>
<div>output data with the worker Python processes.</div></blockquote>
<ul class="simple">
<li>“multiprocessing” previous process-based backend based on multiprocessing.Pool. Less robust than loky.</li>
<li>“threading” is a very low-overhead backend but it suffers from the Python Global Interpreter Lock if the
called function relies a lot on Python objects.</li>
</ul>
<p>Default value is None. In this case the default backend selected by joblib will be used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str, optional</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">add_arm</span><span class="p">(</span><span class="s1">&#39;Arm3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">([</span><span class="s1">&#39;Arm3&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm3&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(),</span> <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">KNearest</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="go">[&#39;Arm2&#39;, &#39;Arm2&#39;, &#39;Arm2&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">add_arm</span><span class="p">(</span><span class="s1">&#39;Arm3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">([</span><span class="s1">&#39;Arm3&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">&#39;Arm3&#39;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mabwiser.mab.MAB.add_arm">
<code class="descname">add_arm</code><span class="sig-paren">(</span><em>arm: NewType.&lt;locals&gt;.new_type</em>, <em>binarizer: Callable = None</em>, <em>scaler: Callable = None</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.mab.MAB.add_arm" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an _arm_ to the list of arms.</p>
<p>Incorporates the arm into the learning and neighborhood policies with no training data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arm</strong> (<em>Arm</em>) – The new arm to be added.</li>
<li><strong>binarizer</strong> (<em>Callable</em>) – The new binarizer function for Thompson Sampling.</li>
<li><strong>scaler</strong> (<em>Callable</em>) – A scaler object from sklearn.preprocessing.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">No return.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>TypeError:  For ThompsonSampling, binarizer must be a callable function.</li>
<li>TypeError:  The standard scaler object must have a transform method.</li>
<li>TypeError:  The standard scaler object must be fit with calculated <a href="#id1"><span class="problematic" id="id2">mean_</span></a> and <a href="#id3"><span class="problematic" id="id4">var_</span></a> attributes.</li>
<li>ValueError: A binarizer function was provided but the learning policy is not Thompson Sampling.</li>
<li>ValueError: The arm already exists.</li>
<li>ValueError: The arm is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</li>
<li>ValueError: The arm is <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</li>
<li>ValueError: The arm is <code class="docutils literal notranslate"><span class="pre">Infinity</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mabwiser.mab.MAB.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>decisions: Union[List[NewType.&lt;locals&gt;.new_type], numpy.ndarray, pandas.core.series.Series], rewards: Union[List[Union[int, float]], numpy.ndarray, pandas.core.series.Series], contexts: Union[None, List[List[Union[int, float]]], numpy.ndarray, pandas.core.series.Series, pandas.core.frame.DataFrame] = None</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.mab.MAB.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the multi-armed bandit to the given <em>decisions</em>, their corresponding <em>rewards</em>
and <em>contexts</em>, if any.</p>
<p>Validates arguments and raises exceptions in case there are violations.</p>
<dl class="docutils">
<dt>This function makes the following assumptions:</dt>
<dd><ul class="first last simple">
<li>each decision corresponds to an arm of the bandit.</li>
<li>there are no <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">Nan</span></code>, or <code class="docutils literal notranslate"><span class="pre">Infinity</span></code> values in the contexts.</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>decisions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>Arm</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>]</em>) – The decisions that are made.</li>
<li><strong>rewards</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>]</em>) – The rewards that are received corresponding to the decisions.</li>
<li><strong>contexts</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>List</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The context under which each decision is made. Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>, i.e., no contexts.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">No return.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>TypeError:  Decisions and rewards are not given as list, numpy array or pandas series.</li>
<li>TypeError:  Contexts is not given as <code class="docutils literal notranslate"><span class="pre">None</span></code>, list, numpy array, pandas series or data frames.</li>
<li>ValueError: Length mismatch between decisions, rewards, and contexts.</li>
<li>ValueError: Fitting contexts data when there is no contextual policy.</li>
<li>ValueError: Contextual policy when fitting no contexts data.</li>
<li>ValueError: Rewards contain <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">Nan</span></code>, or <code class="docutils literal notranslate"><span class="pre">Infinity</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">learning_policy</code></dt>
<dd><p>Creates named tuple of the learning policy based on the implementor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">The learning policy.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">NotImplementedError: MAB learning_policy property not implemented for this learning policy.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">neighborhood_policy</code></dt>
<dd><p>Creates named tuple of the neighborhood policy based on the implementor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">The neighborhood policy</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mabwiser.mab.MAB.partial_fit">
<code class="descname">partial_fit</code><span class="sig-paren">(</span><em>decisions: Union[List[NewType.&lt;locals&gt;.new_type], numpy.ndarray, pandas.core.series.Series], rewards: Union[List[Union[int, float]], numpy.ndarray, pandas.core.series.Series], contexts: Union[None, List[List[Union[int, float]]], numpy.ndarray, pandas.core.series.Series, pandas.core.frame.DataFrame] = None</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.mab.MAB.partial_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the multi-armed bandit with the given <em>decisions</em>, their corresponding <em>rewards</em>
and <em>contexts</em>, if any.</p>
<p>Validates arguments and raises exceptions in case there are violations.</p>
<dl class="docutils">
<dt>This function makes the following assumptions:</dt>
<dd><ul class="first last simple">
<li>each decision corresponds to an arm of the bandit.</li>
<li>there are no <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">Nan</span></code>, or <code class="docutils literal notranslate"><span class="pre">Infinity</span></code> values in the contexts.</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>decisions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>Arm</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>]</em>) – The decisions that are made.</li>
<li><strong>rewards</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>]</em>) – The rewards that are received corresponding to the decisions.</li>
<li><strong>contexts</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>List</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>] </em><em>=</em>) – The context under which each decision is made. Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>, i.e., no contexts.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">No return.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>TypeError:  Decisions, rewards are not given as list, numpy array or pandas series.</li>
<li>TypeError:  Contexts is not given as <code class="docutils literal notranslate"><span class="pre">None</span></code>, list, numpy array, pandas series or data frames.</li>
<li>ValueError: Length mismatch between decisions, rewards, and contexts.</li>
<li>ValueError: Fitting contexts data when there is no contextual policy.</li>
<li>ValueError: Contextual policy when fitting no contexts data.</li>
<li>ValueError: Rewards contain <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">Nan</span></code>, or <code class="docutils literal notranslate"><span class="pre">Infinity</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mabwiser.mab.MAB.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>contexts: Union[None, List[Union[int, float]], List[List[Union[int, float]]], numpy.ndarray, pandas.core.series.Series, pandas.core.frame.DataFrame] = None</em><span class="sig-paren">)</span> &#x2192; Union[NewType.&lt;locals&gt;.new_type, List[NewType.&lt;locals&gt;.new_type]]<a class="headerlink" href="#mabwiser.mab.MAB.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the “best” arm (or arms list if multiple contexts are given) based on the expected reward.</p>
<p>The definition of the <em>best</em> depends on the specified learning policy.
Contextual learning policies and neighborhood policies require contexts data in training.
In testing, they return the best arm given new context(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>contexts</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>List</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The context under which each decision is made. Default value is None.
Contexts should be <code class="docutils literal notranslate"><span class="pre">None</span></code> for context-free bandits and is required for contextual bandits.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">The recommended arm or recommended arms list.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>TypeError:  Contexts is not given as <code class="docutils literal notranslate"><span class="pre">None</span></code>, list, numpy array, pandas series or data frames.</li>
<li>ValueError: Predicting with contexts data when there is no contextual policy.</li>
<li>ValueError: Contextual policy when predicting with no contexts data.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mabwiser.mab.MAB.predict_expectations">
<code class="descname">predict_expectations</code><span class="sig-paren">(</span><em>contexts: Union[None, List[Union[int, float]], List[List[Union[int, float]]], numpy.ndarray, pandas.core.series.Series, pandas.core.frame.DataFrame] = None</em><span class="sig-paren">)</span> &#x2192; Union[Dict[NewType.&lt;locals&gt;.new_type, Union[int, float]], List[Dict[NewType.&lt;locals&gt;.new_type, Union[int, float]]]]<a class="headerlink" href="#mabwiser.mab.MAB.predict_expectations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of arms (key) to their expected rewards (value).</p>
<p>Contextual learning policies and neighborhood policies require contexts data for expected rewards.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>contexts</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>List</em><em>[</em><em>Num</em><em>]</em><em>, </em><em>List</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The context for the expected rewards. Default value is None.
Contexts should be <code class="docutils literal notranslate"><span class="pre">None</span></code> for context-free bandits and is required for contextual bandits.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">The dictionary of arms (key) to their expected rewards (value), or a list of such dictionaries.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>TypeError:  Contexts is not given as <code class="docutils literal notranslate"><span class="pre">None</span></code>, list, numpy array or pandas data frames.</li>
<li>ValueError: Predicting with contexts data when there is no contextual policy.</li>
<li>ValueError: Contextual policy when predicting with no contexts data.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.NeighborhoodPolicy">
<em class="property">class </em><code class="descclassname">mabwiser.mab.</code><code class="descname">NeighborhoodPolicy</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="class">
<dt id="mabwiser.mab.NeighborhoodPolicy.Clusters">
<em class="property">class </em><code class="descname">Clusters</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Clusters Neighborhood Policy.</p>
<p>Clusters is a k-means clustering approach that uses the observations
from the closest <em>cluster</em> with a learning policy.
Supports <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> and <code class="docutils literal notranslate"><span class="pre">MiniBatchKMeans</span></code>.</p>
<dl class="attribute">
<dt id="mabwiser.mab.NeighborhoodPolicy.Clusters.n_clusters">
<code class="descname">n_clusters</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Clusters.n_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of clusters. Integer. Must be at least 2. Default value is 2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Num</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.NeighborhoodPolicy.Clusters.is_minibatch">
<code class="descname">is_minibatch</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Clusters.is_minibatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean flag to use <code class="docutils literal notranslate"><span class="pre">MiniBatchKMeans</span></code> or not. Default value is False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>                             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">Clusters</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">[3, 1]</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">is_minibatch</code></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">n_clusters</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.NeighborhoodPolicy.KNearest">
<em class="property">class </em><code class="descname">KNearest</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.KNearest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>KNearest Neighborhood Policy.</p>
<p>KNearest is a nearest neighbors approach that selects the <em>k-nearest</em> observations
to be used with a learning policy.</p>
<dl class="attribute">
<dt id="mabwiser.mab.NeighborhoodPolicy.KNearest.k">
<code class="descname">k</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.KNearest.k" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of neighbors to select.
Integer value. Must be greater than zero.
Default value is 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.NeighborhoodPolicy.KNearest.metric">
<code class="descname">metric</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.KNearest.metric" title="Permalink to this definition">¶</a></dt>
<dd><p>The metric used to calculate distance.
Accepts any of the metrics supported by <code class="docutils literal notranslate"><span class="pre">scipy.spatial.distance.cdist</span></code>.
Default value is Euclidean distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>                             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>                           <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">KNearest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;euclidean&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">k</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">metric</code></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mabwiser.mab.NeighborhoodPolicy.Radius">
<em class="property">class </em><code class="descname">Radius</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Radius Neighborhood Policy.</p>
<p>Radius is a nearest neighborhood approach that selects the observations
within a given <em>radius</em> to be used with a learning policy.</p>
<dl class="attribute">
<dt id="mabwiser.mab.NeighborhoodPolicy.Radius.radius">
<code class="descname">radius</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Radius.radius" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum distance within which to select observations.
Integer or Float. Must be greater than zero.
Default value is 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Num</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.NeighborhoodPolicy.Radius.metric">
<code class="descname">metric</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Radius.metric" title="Permalink to this definition">¶</a></dt>
<dd><p>The metric used to calculate distance.
Accepts any of the metrics supported by scipy.spatial.distance.cdist.
Default value is Euclidean distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.mab.NeighborhoodPolicy.Radius.no_nhood_prob_of_arm">
<code class="descname">no_nhood_prob_of_arm</code><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Radius.no_nhood_prob_of_arm" title="Permalink to this definition">¶</a></dt>
<dd><p>The probabilities associated with each arm.
If not given, a uniform random distribution over all arms is assumed.
The probabilities should sum up to 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">None or List</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>                             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>                           <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">Radius</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;euclidean&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">[3, 1]</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">metric</code></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">no_nhood_prob_of_arm</code></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">radius</code></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mabwiser.simulator">
<span id="simulator"></span><h2>simulator<a class="headerlink" href="#module-mabwiser.simulator" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">FMR LLC</td>
</tr>
<tr class="field-even field"><th class="field-name">Email:</th><td class="field-body"><a class="reference external" href="mailto:mabwiser&#37;&#52;&#48;fmr&#46;com">mabwiser<span>&#64;</span>fmr<span>&#46;</span>com</a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Version:</th><td class="field-body">1.8.0 of January 21, 2020</td>
</tr>
</tbody>
</table>
<p>This module provides a simulation utility for comparing algorithms and hyper-parameter tuning.</p>
<dl class="class">
<dt id="mabwiser.simulator.Simulator">
<em class="property">class </em><code class="descclassname">mabwiser.simulator.</code><code class="descname">Simulator</code><span class="sig-paren">(</span><em>bandits: List[tuple], decisions: Union[List[NewType.&lt;locals&gt;.new_type], numpy.ndarray, pandas.core.series.Series], rewards: Union[List[Union[int, float]], numpy.ndarray, pandas.core.series.Series], contexts: Union[None, List[List[Union[int, float]]], numpy.ndarray, pandas.core.series.Series, pandas.core.frame.DataFrame] = None, scaler: callable = None, test_size: float = 0.3, is_ordered: bool = False, batch_size: int = 0, evaluator: callable = &lt;function default_evaluator&gt;, seed: int = 123456, is_quick: bool = False, log_file: str = None, log_format: str = '%(asctime)s %(levelname)s %(message)s'</em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.simulator.Simulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Multi-Armed Bandit Simulator.</p>
<p>This utility runs a simulation using historic data and a collection of multi-armed bandits from the MABWiser
library or that extends the BaseMAB class in MABWiser.</p>
<p>It can be used to run a simple simulation with a single bandit or to compare multiple bandits for policy selection,
hyper-parameter tuning, etc.</p>
<p>Nearest Neighbor bandits that use the default Radius and KNearest implementations from MABWiser are converted to
custom versions that share distance calculations to speed up the simulation. These custom versions also track
statistics about the neighborhoods that can be used in evaluation.</p>
<p>The results can be accessed as the arms_to_stats, model_to_predictions, model_to_confusion_matrices, and
models_to_evaluations properties.</p>
<p>When using partial fitting, an additional confusion matrix is calculated for all predictions after all of the
batches are processed.</p>
<p>A log of the simulation tracks the experiment progress.</p>
<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.bandits">
<code class="descname">bandits</code><a class="headerlink" href="#mabwiser.simulator.Simulator.bandits" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of tuples of the name of each bandit and the bandit object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list[(str, bandit)]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.decisions">
<code class="descname">decisions</code><a class="headerlink" href="#mabwiser.simulator.Simulator.decisions" title="Permalink to this definition">¶</a></dt>
<dd><p>The complete decision history to be used in train and test.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.rewards">
<code class="descname">rewards</code><a class="headerlink" href="#mabwiser.simulator.Simulator.rewards" title="Permalink to this definition">¶</a></dt>
<dd><p>The complete array history to be used in train and test.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.contexts">
<code class="descname">contexts</code><a class="headerlink" href="#mabwiser.simulator.Simulator.contexts" title="Permalink to this definition">¶</a></dt>
<dd><p>The complete context history to be used in train and test.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.scaler">
<code class="descname">scaler</code><a class="headerlink" href="#mabwiser.simulator.Simulator.scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>A scaler object from sklearn.preprocessing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">scaler</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.test_size">
<code class="descname">test_size</code><a class="headerlink" href="#mabwiser.simulator.Simulator.test_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The size of the test set</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.is_ordered">
<code class="descname">is_ordered</code><a class="headerlink" href="#mabwiser.simulator.Simulator.is_ordered" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to use a chronological division for the train-test split.
If false, uses sklearn’s train_test_split.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.batch_size">
<code class="descname">batch_size</code><a class="headerlink" href="#mabwiser.simulator.Simulator.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The size of each batch for online learning.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.evaluator">
<code class="descname">evaluator</code><a class="headerlink" href="#mabwiser.simulator.Simulator.evaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>The function for evaluating the bandits. Values are stored in bandit_to_arm_to_stats_avg.
Must have the function signature function(arms_to_stats_train: dictionary, predictions: list,
decisions: np.ndarray, rewards: np.ndarray, metric: str).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">callable</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.is_quick">
<code class="descname">is_quick</code><a class="headerlink" href="#mabwiser.simulator.Simulator.is_quick" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag to skip neighborhood statistics.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.logger">
<code class="descname">logger</code><a class="headerlink" href="#mabwiser.simulator.Simulator.logger" title="Permalink to this definition">¶</a></dt>
<dd><p>The logger object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Logger</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.arms">
<code class="descname">arms</code><a class="headerlink" href="#mabwiser.simulator.Simulator.arms" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of arms used by the bandits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.arm_to_stats_total">
<code class="descname">arm_to_stats_total</code><a class="headerlink" href="#mabwiser.simulator.Simulator.arm_to_stats_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive statistics for the complete data set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.arm_to_stats_train">
<code class="descname">arm_to_stats_train</code><a class="headerlink" href="#mabwiser.simulator.Simulator.arm_to_stats_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive statistics for the training data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.arm_to_stats_test">
<code class="descname">arm_to_stats_test</code><a class="headerlink" href="#mabwiser.simulator.Simulator.arm_to_stats_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive statistics for the test data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.bandit_to_arm_to_stats_avg">
<code class="descname">bandit_to_arm_to_stats_avg</code><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_avg" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive statistics for the predictions made by each bandit based on means from training data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.bandit_to_arm_to_stats_min">
<code class="descname">bandit_to_arm_to_stats_min</code><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive statistics for the predictions made by each bandit based on minimums from training data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.bandit_to_arm_to_stats_max">
<code class="descname">bandit_to_arm_to_stats_max</code><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive statistics for the predictions made by each bandit based on maximums from training data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.bandit_to_confusion_matrices">
<code class="descname">bandit_to_confusion_matrices</code><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_confusion_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>The confusion matrices for each bandit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.bandit_to_predictions">
<code class="descname">bandit_to_predictions</code><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>The prediction for each item in the test set for each bandit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.bandit_to_expectations">
<code class="descname">bandit_to_expectations</code><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_expectations" title="Permalink to this definition">¶</a></dt>
<dd><p>The arm_to_expectations for each item in the test set for each bandit.
For context-free bandits, there is a single dictionary for each batch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.bandit_to_neighborhood_size">
<code class="descname">bandit_to_neighborhood_size</code><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_neighborhood_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of neighbors in each neighborhood for each row in the test set.
Calculated when using a Radius neighborhood policy, or a custom class that inherits from it.
Not calculated when is_quick is True.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.bandit_to_arm_to_stats_neighborhoods">
<code class="descname">bandit_to_arm_to_stats_neighborhoods</code><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_neighborhoods" title="Permalink to this definition">¶</a></dt>
<dd><p>The arm_to_stats for each neighborhood for each row in the test set.
Calculated when using Radius or KNearest, or a custom class that inherits from one of them.
Not calculated when is_quick is True.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.simulator.Simulator.test_indices">
<code class="descname">test_indices</code><a class="headerlink" href="#mabwiser.simulator.Simulator.test_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>The indices of the rows in the test set.
If input was not zero-indexed, these will reflect their position in the input rather than actual index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="k">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab1</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab2</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.30</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandits</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;EG 25%&#39;</span><span class="p">,</span> <span class="n">mab1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;EG 30%&#39;</span><span class="p">,</span> <span class="n">mab2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offline_sim</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="n">bandits</span><span class="p">,</span> <span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offline_sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offline_sim</span><span class="o">.</span><span class="n">bandit_to_arm_to_stats_avg</span><span class="p">[</span><span class="s1">&#39;EG 30%&#39;</span><span class="p">][</span><span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="go">{&#39;count&#39;: 1, &#39;sum&#39;: 9, &#39;min&#39;: 9, &#39;max&#39;: 9, &#39;mean&#39;: 9.0, &#39;std&#39;: 0.0}</span>
</pre></div>
</div>
<dl class="method">
<dt id="mabwiser.simulator.Simulator.get_arm_stats">
<code class="descname">get_arm_stats</code><span class="sig-paren">(</span><em>decisions: numpy.ndarray</em>, <em>rewards: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#mabwiser.simulator.Simulator.get_arm_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates descriptive statistics for each arm in the provided data set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>decisions</strong> (<em>np.ndarray</em>) – The decisions to filter the rewards.</li>
<li><strong>rewards</strong> (<em>np.ndarray</em>) – The rewards to get statistics about.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>Arm_to_stats dictionary.</em></li>
<li><em>Dictionary has the format {arm {‘count’, ‘sum’, ‘min’, ‘max’, ‘mean’, ‘std’}}</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="mabwiser.simulator.Simulator.get_stats">
<em class="property">static </em><code class="descname">get_stats</code><span class="sig-paren">(</span><em>rewards: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#mabwiser.simulator.Simulator.get_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates descriptive statistics for the given array of rewards.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rewards</strong> (<em>nd.nparray</em>) – Array of rewards for a single arm.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>A dictionary of descriptive statistics.</em></li>
<li><em>Dictionary has the format {‘count’, ‘sum’, ‘min’, ‘max’, ‘mean’, ‘std’}</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mabwiser.simulator.Simulator.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>metric: str = 'avg'</em>, <em>is_per_arm: bool = False</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.simulator.Simulator.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a plot of the cumulative sum of the rewards for each bandit.
Simulation must be run before calling this method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<em>str</em>) – The bandit_to_arm_to_stats to use to generate the plot. Must be ‘avg’, ‘min’, or ‘max</li>
<li><strong>is_per_arm</strong> (<em>bool</em>) – Whether to plot each arm separately or use an aggregate statistic.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first simple">
<li>AssertionError  Descriptive statics for predictions are missing.</li>
<li>TypeError       Metric must be a string.</li>
<li>TypeError       The per_arm flag must be a boolean.</li>
<li>ValueError      The metric must be one of avg, min or max.</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mabwiser.simulator.Simulator.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.simulator.Simulator.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run simulator</p>
<p>Runs a simulation concurrently for all bandits in the bandits list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mabwiser.simulator.default_evaluator">
<code class="descclassname">mabwiser.simulator.</code><code class="descname">default_evaluator</code><span class="sig-paren">(</span><em>arms: List[NewType.&lt;locals&gt;.new_type], decisions: numpy.ndarray, rewards: numpy.ndarray, predictions: List[NewType.&lt;locals&gt;.new_type], arm_to_stats: dict, stat: str, start_index: int, nn: bool = False</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#mabwiser.simulator.default_evaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Default evaluation function.</p>
<p>Calculates predicted rewards for the test batch based on predicted arms.
When the predicted arm is the same as the historic decision, the historic reward is used.
When the predicted arm is different, the mean, min or max reward from the training data is used.
If using Radius or KNearest neighborhood policy, the statistics from the neighborhood are used
instead of the entire training set.</p>
<p>The simulator supports custom evaluation functions,
but they must have this signature to work with the simulation pipeline.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arms</strong> (<em>list</em>) – The list of arms.</li>
<li><strong>decisions</strong> (<em>np.ndarray</em>) – The historic decisions for the batch being evaluated.</li>
<li><strong>rewards</strong> (<em>np.ndarray</em>) – The historic rewards for the batch being evaluated.</li>
<li><strong>predictions</strong> (<em>list</em>) – The predictions for the batch being evaluated.</li>
<li><strong>arm_to_stats</strong> (<em>dict</em>) – The dictionary of descriptive statistics for each arm to use in evaluation.</li>
<li><strong>stat</strong> (<em>str</em>) – Which metric from arm_to_stats to use. Takes the values ‘min’, ‘max’, ‘mean’.</li>
<li><strong>start_index</strong> (<em>int</em>) – The index of the first row in the batch.
For offline simulations it is 0.
For _online simulations it is batch size * batch number.
Used to select the correct index from arm_to_stats if there are separate entries for each row in the test set.</li>
<li><strong>nn</strong> (<em>bool</em>) – Whether the results are from one of the simulator custom nearest neighbors implementations.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>An arm_to_stats dictionary for the predictions in the batch.</em></li>
<li><em>Dictionary has the format {arm {‘count’, ‘sum’, ‘min’, ‘max’, ‘mean’, ‘std’}}</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mabwiser.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-mabwiser.utils" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">FMR LLC</td>
</tr>
<tr class="field-even field"><th class="field-name">Email:</th><td class="field-body"><a class="reference external" href="mailto:mabwiser&#37;&#52;&#48;fmr&#46;com">mabwiser<span>&#64;</span>fmr<span>&#46;</span>com</a></td>
</tr>
</tbody>
</table>
<p>This module provides a number of constants and helper functions.</p>
<dl class="function">
<dt id="mabwiser.utils.Arm">
<code class="descclassname">mabwiser.utils.</code><code class="descname">Arm</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.utils.Arm" title="Permalink to this definition">¶</a></dt>
<dd><p>Arm type is defined as integer, float, or string.</p>
</dd></dl>

<dl class="class">
<dt id="mabwiser.utils.Constants">
<em class="property">class </em><code class="descclassname">mabwiser.utils.</code><code class="descname">Constants</code><a class="headerlink" href="#mabwiser.utils.Constants" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Constant values used by the modules.</p>
<dl class="attribute">
<dt id="mabwiser.utils.Constants.default_seed">
<code class="descname">default_seed</code><em class="property"> = 123456</em><a class="headerlink" href="#mabwiser.utils.Constants.default_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>The default random seed.</p>
</dd></dl>

<dl class="attribute">
<dt id="mabwiser.utils.Constants.distance_metrics">
<code class="descname">distance_metrics</code><em class="property"> = ['braycurtis', 'canberra', 'chebyshev', 'cityblock', 'correlation', 'cosine', 'dice', 'euclidean', 'hamming', 'jaccard', 'kulsinski', 'mahalanobis', 'matching', 'minkowski', 'rogerstanimoto', 'russellrao', 'seuclidean', 'sokalmichener', 'sokalsneath', 'sqeuclidean']</em><a class="headerlink" href="#mabwiser.utils.Constants.distance_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>The distance metrics supported by neighborhood policies.</p>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="mabwiser.utils.Num">
<code class="descclassname">mabwiser.utils.</code><code class="descname">Num</code><em class="property"> = typing.Union[int, float]</em><a class="headerlink" href="#mabwiser.utils.Num" title="Permalink to this definition">¶</a></dt>
<dd><p>Num type is defined as integer or float.</p>
</dd></dl>

<dl class="function">
<dt id="mabwiser.utils.argmax">
<code class="descclassname">mabwiser.utils.</code><code class="descname">argmax</code><span class="sig-paren">(</span><em>dictionary: Dict[NewType.&lt;locals&gt;.new_type, Union[int, float]]</em><span class="sig-paren">)</span> &#x2192; NewType.&lt;locals&gt;.new_type<a class="headerlink" href="#mabwiser.utils.argmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the first key with the maximum value.</p>
</dd></dl>

<dl class="function">
<dt id="mabwiser.utils.check_false">
<code class="descclassname">mabwiser.utils.</code><code class="descname">check_false</code><span class="sig-paren">(</span><em>expression: bool</em>, <em>exception: Exception</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.utils.check_false" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that given expression is false, otherwise raises the given exception.</p>
</dd></dl>

<dl class="function">
<dt id="mabwiser.utils.check_true">
<code class="descclassname">mabwiser.utils.</code><code class="descname">check_true</code><span class="sig-paren">(</span><em>expression: bool</em>, <em>exception: Exception</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.utils.check_true" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that given expression is true, otherwise raises the given exception.</p>
</dd></dl>

<dl class="function">
<dt id="mabwiser.utils.reset">
<code class="descclassname">mabwiser.utils.</code><code class="descname">reset</code><span class="sig-paren">(</span><em>dictionary: Dict[KT, VT], value</em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="headerlink" href="#mabwiser.utils.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps every key to the given value.</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="contributing.html" class="btn btn-neutral float-left" title="Contributing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, FMR LLC

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>