<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MABWiser Public API &mdash; MABWiser 2.7.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=e8140b17"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Adding a New Bandit" href="new_bandit.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MABWiser
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About Multi-Armed Bandits</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Usage Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="new_bandit.html">Adding a New Bandit</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MABWiser Public API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-mabwiser.base_mab">base_mab</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB"><code class="docutils literal notranslate"><span class="pre">BaseMAB</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.rng"><code class="docutils literal notranslate"><span class="pre">BaseMAB.rng</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.arms"><code class="docutils literal notranslate"><span class="pre">BaseMAB.arms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.n_jobs"><code class="docutils literal notranslate"><span class="pre">BaseMAB.n_jobs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.backend"><code class="docutils literal notranslate"><span class="pre">BaseMAB.backend</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.arm_to_expectation"><code class="docutils literal notranslate"><span class="pre">BaseMAB.arm_to_expectation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.arm_to_status"><code class="docutils literal notranslate"><span class="pre">BaseMAB.arm_to_status</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.add_arm"><code class="docutils literal notranslate"><span class="pre">BaseMAB.add_arm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.cold_arms"><code class="docutils literal notranslate"><span class="pre">BaseMAB.cold_arms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.fit"><code class="docutils literal notranslate"><span class="pre">BaseMAB.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.partial_fit"><code class="docutils literal notranslate"><span class="pre">BaseMAB.partial_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.predict"><code class="docutils literal notranslate"><span class="pre">BaseMAB.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.predict_expectations"><code class="docutils literal notranslate"><span class="pre">BaseMAB.predict_expectations()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.remove_arm"><code class="docutils literal notranslate"><span class="pre">BaseMAB.remove_arm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.trained_arms"><code class="docutils literal notranslate"><span class="pre">BaseMAB.trained_arms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.base_mab.BaseMAB.warm_start"><code class="docutils literal notranslate"><span class="pre">BaseMAB.warm_start()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-mabwiser.mab">mab</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.mab.LearningPolicy"><code class="docutils literal notranslate"><span class="pre">LearningPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.LearningPolicy.EpsilonGreedy"><code class="docutils literal notranslate"><span class="pre">LearningPolicy.EpsilonGreedy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.LearningPolicy.LinGreedy"><code class="docutils literal notranslate"><span class="pre">LearningPolicy.LinGreedy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.LearningPolicy.LinTS"><code class="docutils literal notranslate"><span class="pre">LearningPolicy.LinTS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.LearningPolicy.LinUCB"><code class="docutils literal notranslate"><span class="pre">LearningPolicy.LinUCB</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.LearningPolicy.Popularity"><code class="docutils literal notranslate"><span class="pre">LearningPolicy.Popularity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.LearningPolicy.Random"><code class="docutils literal notranslate"><span class="pre">LearningPolicy.Random</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.LearningPolicy.Softmax"><code class="docutils literal notranslate"><span class="pre">LearningPolicy.Softmax</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.LearningPolicy.ThompsonSampling"><code class="docutils literal notranslate"><span class="pre">LearningPolicy.ThompsonSampling</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.LearningPolicy.UCB1"><code class="docutils literal notranslate"><span class="pre">LearningPolicy.UCB1</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.mab.MAB"><code class="docutils literal notranslate"><span class="pre">MAB</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.arms"><code class="docutils literal notranslate"><span class="pre">MAB.arms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.learning_policy"><code class="docutils literal notranslate"><span class="pre">MAB.learning_policy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.neighborhood_policy"><code class="docutils literal notranslate"><span class="pre">MAB.neighborhood_policy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.is_contextual"><code class="docutils literal notranslate"><span class="pre">MAB.is_contextual</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.seed"><code class="docutils literal notranslate"><span class="pre">MAB.seed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.n_jobs"><code class="docutils literal notranslate"><span class="pre">MAB.n_jobs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.backend"><code class="docutils literal notranslate"><span class="pre">MAB.backend</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.add_arm"><code class="docutils literal notranslate"><span class="pre">MAB.add_arm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.cold_arms"><code class="docutils literal notranslate"><span class="pre">MAB.cold_arms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.fit"><code class="docutils literal notranslate"><span class="pre">MAB.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">MAB.learning_policy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">MAB.neighborhood_policy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.partial_fit"><code class="docutils literal notranslate"><span class="pre">MAB.partial_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.predict"><code class="docutils literal notranslate"><span class="pre">MAB.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.predict_expectations"><code class="docutils literal notranslate"><span class="pre">MAB.predict_expectations()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.remove_arm"><code class="docutils literal notranslate"><span class="pre">MAB.remove_arm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.MAB.warm_start"><code class="docutils literal notranslate"><span class="pre">MAB.warm_start()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.mab.NeighborhoodPolicy"><code class="docutils literal notranslate"><span class="pre">NeighborhoodPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.NeighborhoodPolicy.Clusters"><code class="docutils literal notranslate"><span class="pre">NeighborhoodPolicy.Clusters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.NeighborhoodPolicy.KNearest"><code class="docutils literal notranslate"><span class="pre">NeighborhoodPolicy.KNearest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.NeighborhoodPolicy.LSHNearest"><code class="docutils literal notranslate"><span class="pre">NeighborhoodPolicy.LSHNearest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.NeighborhoodPolicy.Radius"><code class="docutils literal notranslate"><span class="pre">NeighborhoodPolicy.Radius</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.mab.NeighborhoodPolicy.TreeBandit"><code class="docutils literal notranslate"><span class="pre">NeighborhoodPolicy.TreeBandit</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-mabwiser.simulator">simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.simulator.Simulator"><code class="docutils literal notranslate"><span class="pre">Simulator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.bandits"><code class="docutils literal notranslate"><span class="pre">Simulator.bandits</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.decisions"><code class="docutils literal notranslate"><span class="pre">Simulator.decisions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.rewards"><code class="docutils literal notranslate"><span class="pre">Simulator.rewards</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.contexts"><code class="docutils literal notranslate"><span class="pre">Simulator.contexts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.scaler"><code class="docutils literal notranslate"><span class="pre">Simulator.scaler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.test_size"><code class="docutils literal notranslate"><span class="pre">Simulator.test_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.is_ordered"><code class="docutils literal notranslate"><span class="pre">Simulator.is_ordered</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.batch_size"><code class="docutils literal notranslate"><span class="pre">Simulator.batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.evaluator"><code class="docutils literal notranslate"><span class="pre">Simulator.evaluator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.is_quick"><code class="docutils literal notranslate"><span class="pre">Simulator.is_quick</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.logger"><code class="docutils literal notranslate"><span class="pre">Simulator.logger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.arms"><code class="docutils literal notranslate"><span class="pre">Simulator.arms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.arm_to_stats_total"><code class="docutils literal notranslate"><span class="pre">Simulator.arm_to_stats_total</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.arm_to_stats_train"><code class="docutils literal notranslate"><span class="pre">Simulator.arm_to_stats_train</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.arm_to_stats_test"><code class="docutils literal notranslate"><span class="pre">Simulator.arm_to_stats_test</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_avg"><code class="docutils literal notranslate"><span class="pre">Simulator.bandit_to_arm_to_stats_avg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_min"><code class="docutils literal notranslate"><span class="pre">Simulator.bandit_to_arm_to_stats_min</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_max"><code class="docutils literal notranslate"><span class="pre">Simulator.bandit_to_arm_to_stats_max</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.bandit_to_confusion_matrices"><code class="docutils literal notranslate"><span class="pre">Simulator.bandit_to_confusion_matrices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.bandit_to_predictions"><code class="docutils literal notranslate"><span class="pre">Simulator.bandit_to_predictions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.bandit_to_expectations"><code class="docutils literal notranslate"><span class="pre">Simulator.bandit_to_expectations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.bandit_to_neighborhood_size"><code class="docutils literal notranslate"><span class="pre">Simulator.bandit_to_neighborhood_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_neighborhoods"><code class="docutils literal notranslate"><span class="pre">Simulator.bandit_to_arm_to_stats_neighborhoods</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.test_indices"><code class="docutils literal notranslate"><span class="pre">Simulator.test_indices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.get_arm_stats"><code class="docutils literal notranslate"><span class="pre">Simulator.get_arm_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.get_stats"><code class="docutils literal notranslate"><span class="pre">Simulator.get_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.plot"><code class="docutils literal notranslate"><span class="pre">Simulator.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.simulator.Simulator.run"><code class="docutils literal notranslate"><span class="pre">Simulator.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.simulator.default_evaluator"><code class="docutils literal notranslate"><span class="pre">default_evaluator()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-mabwiser.utils">utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.utils.Arm"><code class="docutils literal notranslate"><span class="pre">Arm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.utils.Constants"><code class="docutils literal notranslate"><span class="pre">Constants</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.utils.Constants.default_seed"><code class="docutils literal notranslate"><span class="pre">Constants.default_seed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mabwiser.utils.Constants.distance_metrics"><code class="docutils literal notranslate"><span class="pre">Constants.distance_metrics</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.utils.Num"><code class="docutils literal notranslate"><span class="pre">Num</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.utils.argmax"><code class="docutils literal notranslate"><span class="pre">argmax()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.utils.argmin"><code class="docutils literal notranslate"><span class="pre">argmin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.utils.check_false"><code class="docutils literal notranslate"><span class="pre">check_false()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.utils.check_true"><code class="docutils literal notranslate"><span class="pre">check_true()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.utils.create_rng"><code class="docutils literal notranslate"><span class="pre">create_rng()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#mabwiser.utils.reset"><code class="docutils literal notranslate"><span class="pre">reset()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MABWiser</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">MABWiser Public API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mabwiser-public-api">
<span id="mabwiser-api"></span><h1>MABWiser Public API<a class="headerlink" href="#mabwiser-public-api" title="Link to this heading"></a></h1>
<section id="module-mabwiser.base_mab">
<span id="base-mab"></span><h2>base_mab<a class="headerlink" href="#module-mabwiser.base_mab" title="Link to this heading"></a></h2>
<p>This module defines the abstract base class for contextual multi-armed bandit algorithms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mabwiser.base_mab.</span></span><span class="sig-name descname"><span class="pre">BaseMAB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_BaseRNG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for multi-armed bandits.</p>
<p>This module is not intended to be used directly, instead it declares
the basic skeleton of multi-armed bandits together with a set of parameters
that are common to every bandit algorithm.</p>
<p>It declares abstract methods that sub-classes can override to
implement specific bandit policies using:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code> constructor to initialize the bandit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">add_arm</span></code> method to add a new arm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fit</span></code> method for training</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> method for _online learning</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_expectations</span></code> method to retrieve the expectation of each arm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict</span></code> method for testing to retrieve the best arm based on the policy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_arm</span></code> method for removing an arm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warm_start</span></code> method for warm starting untrained (cold) arms</p></li>
</ul>
<p>To ensure this is the case, alpha and l2_lambda are required to be greater than zero.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.rng">
<span class="sig-name descname"><span class="pre">rng</span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.rng" title="Link to this definition"></a></dt>
<dd><p>The random number generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>_BaseRNG</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.arms">
<span class="sig-name descname"><span class="pre">arms</span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.arms" title="Link to this definition"></a></dt>
<dd><p>The list of all arms.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.n_jobs">
<span class="sig-name descname"><span class="pre">n_jobs</span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.n_jobs" title="Link to this definition"></a></dt>
<dd><p>This is used to specify how many concurrent processes/threads should be used for parallelized routines.
Default value is set to 1.
If set to -1, all CPUs are used.
If set to -2, all CPUs but one are used, and so on.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.backend">
<span class="sig-name descname"><span class="pre">backend</span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.backend" title="Link to this definition"></a></dt>
<dd><p>Specify a parallelization backend implementation supported in the joblib library. Supported options are:
- “loky” used by default, can induce some communication and memory overhead when exchanging input and output.
- “multiprocessing” previous process-based backend based on multiprocessing.Pool. Less robust than loky.
- “threading” is a very low-overhead backend but it suffers from the Python Global Interpreter Lock if the</p>
<blockquote>
<div><p>called function relies a lot on Python objects.</p>
</div></blockquote>
<p>Default value is None. In this case the default backend selected by joblib will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.arm_to_expectation">
<span class="sig-name descname"><span class="pre">arm_to_expectation</span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.arm_to_expectation" title="Link to this definition"></a></dt>
<dd><p>The dictionary of arms (keys) to their expected rewards (values).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm">Arm</a>, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.arm_to_status">
<span class="sig-name descname"><span class="pre">arm_to_status</span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.arm_to_status" title="Link to this definition"></a></dt>
<dd><p>The dictionary of arms (keys) to their status (values), where the status consists of
- <code class="docutils literal notranslate"><span class="pre">is_trained</span></code>, which indicates whether an arm was <code class="docutils literal notranslate"><span class="pre">fit</span></code> or <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code>;
- <code class="docutils literal notranslate"><span class="pre">is_warm</span></code>, which indicates whether an arm was warm started, and therefore has a trained model associated;
- and <code class="docutils literal notranslate"><span class="pre">warm_started_by</span></code>, which indicates the arm that originally warm started this arm.
Arms that were initially warm-started and then updated with <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> will retain <code class="docutils literal notranslate"><span class="pre">is_warm</span></code> as True
with the relevant <code class="docutils literal notranslate"><span class="pre">warm_started_by</span></code> arm for tracking purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm">Arm</a>, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.add_arm">
<span class="sig-name descname"><span class="pre">add_arm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">binarizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.add_arm" title="Link to this definition"></a></dt>
<dd><p>Introduces a new arm to the bandit.</p>
<p>Adds the new arm with zero expectations and
calls the <code class="docutils literal notranslate"><span class="pre">_uptake_new_arm()</span></code> function of the sub-class.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.cold_arms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cold_arms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.cold_arms" title="Link to this definition"></a></dt>
<dd><p>List of cold arms</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decisions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contexts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.fit" title="Link to this definition"></a></dt>
<dd><p>Abstract method.</p>
<p>Fits the multi-armed bandit to the given
decision and reward history and corresponding contexts if any.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.partial_fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">partial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decisions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contexts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.partial_fit" title="Link to this definition"></a></dt>
<dd><p>Abstract method.</p>
<p>Updates the multi-armed bandit with the given
decision and reward history and corresponding contexts if any.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contexts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.predict" title="Link to this definition"></a></dt>
<dd><p>Abstract method.</p>
<p>Returns the predicted arm.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.predict_expectations">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict_expectations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contexts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.predict_expectations" title="Link to this definition"></a></dt>
<dd><p>Abstract method.</p>
<p>Returns a dictionary from arms (keys) to their expected rewards (values).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.remove_arm">
<span class="sig-name descname"><span class="pre">remove_arm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.remove_arm" title="Link to this definition"></a></dt>
<dd><p>Removes arm from the bandit.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.trained_arms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trained_arms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.trained_arms" title="Link to this definition"></a></dt>
<dd><p>List of trained arms.</p>
<p>Arms for which at least one decision has been observed are deemed trained.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.base_mab.BaseMAB.warm_start">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">warm_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arm_to_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.base_mab.BaseMAB.warm_start" title="Link to this definition"></a></dt>
<dd><p>Abstract method.</p>
<p>Warm starts cold arms using similar warm arms based on distances between arm features.
Only implemented for Learning Policies that make use of <code class="docutils literal notranslate"><span class="pre">_warm_start</span></code> method to copy arm information.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mabwiser.mab">
<span id="mab"></span><h2>mab<a class="headerlink" href="#module-mabwiser.mab" title="Link to this heading"></a></h2>
<p>This module defines the public interface of the <strong>MABWiser Library</strong> providing access to the following modules:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MAB</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LearningPolicy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NeighborhoodPolicy</span></code></p></li>
</ul>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mabwiser.mab.</span></span><span class="sig-name descname"><span class="pre">LearningPolicy</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.EpsilonGreedy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EpsilonGreedy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.EpsilonGreedy" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Epsilon Greedy Learning Policy.</p>
<p>This policy selects the arm with the highest expected reward with probability 1 - <span class="math notranslate nohighlight">\(\epsilon\)</span>,
and with probability <span class="math notranslate nohighlight">\(\epsilon\)</span> it selects an arm at random for exploration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.EpsilonGreedy.epsilon">
<span class="sig-name descname"><span class="pre">epsilon</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.EpsilonGreedy.epsilon" title="Link to this definition"></a></dt>
<dd><p>The probability of selecting a random arm for exploration.
Integer or float. Must be between 0 and 1.
Default value is 0.1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm1&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">epsilon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinGreedy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinGreedy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinGreedy" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>LinGreedy Learning Policy.</p>
<p>This policy trains a ridge regression for each arm.
Then, given a given context, it predicts a regression value.
This policy selects the arm with the highest regression value with probability 1 - <span class="math notranslate nohighlight">\(\epsilon\)</span>,
and with probability <span class="math notranslate nohighlight">\(\epsilon\)</span> it selects an arm at random for exploration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinGreedy.epsilon">
<span class="sig-name descname"><span class="pre">epsilon</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinGreedy.epsilon" title="Link to this definition"></a></dt>
<dd><p>The probability of selecting a random arm for exploration.
Integer or float. Must be between 0 and 1.
Default value is 0.1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinGreedy.l2_lambda">
<span class="sig-name descname"><span class="pre">l2_lambda</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinGreedy.l2_lambda" title="Link to this definition"></a></dt>
<dd><p>The regularization strength.
Integer or float. Cannot be negative.
Default value is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinGreedy.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinGreedy.scale" title="Link to this definition"></a></dt>
<dd><p>Whether to scale features to have zero mean and unit variance.
Uses StandardScaler in sklearn.preprocessing.
Default value is False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">LinGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">epsilon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">l2_lambda</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinTS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinTS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinTS" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>LinTS Learning Policy</p>
<p>For each arm LinTS trains a ridge regression and
creates a multivariate normal distribution for the coefficients using the
calculated coefficients as the mean and the covariance as:</p>
<div class="math notranslate nohighlight">
\[\alpha^{2} (x_i^{T}x_i + \lambda * I_d)^{-1}\]</div>
<p>The normal distribution is randomly sampled to obtain
expected coefficients for the ridge regression for each
prediction.</p>
<p><span class="math notranslate nohighlight">\(\alpha\)</span> is a factor used to adjust how conservative the estimate is.
Higher <span class="math notranslate nohighlight">\(\alpha\)</span> values promote more exploration.</p>
<p>The multivariate normal distribution uses Cholesky decomposition to guarantee deterministic behavior.
This method requires that the covariance is a positive definite matrix.
To ensure this is the case, alpha and l2_lambda are required to be greater than zero.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinTS.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinTS.alpha" title="Link to this definition"></a></dt>
<dd><p>The multiplier to determine the degree of exploration.
Integer or float. Must be greater than zero.
Default value is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinTS.l2_lambda">
<span class="sig-name descname"><span class="pre">l2_lambda</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinTS.l2_lambda" title="Link to this definition"></a></dt>
<dd><p>The regularization strength.
Integer or float. Must be greater than zero.
Default value is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinTS.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinTS.scale" title="Link to this definition"></a></dt>
<dd><p>Whether to scale features to have zero mean and unit variance.
Uses StandardScaler in sklearn.preprocessing.
Default value is False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">LinTS</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">alpha</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">l2_lambda</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinUCB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinUCB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinUCB" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>LinUCB Learning Policy.</p>
<p>This policy trains a ridge regression for each arm.
Then, given a given context, it predicts a regression value
and calculates the upper confidence bound of that prediction.
The arm with the highest highest upper bound is selected.</p>
<p>The UCB for each arm is calculated as:</p>
<div class="math notranslate nohighlight">
\[UCB = x_i \beta + \alpha \sqrt{(x_i^{T}x_i + \lambda * I_d)^{-1}x_i}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\beta\)</span> is the matrix of the ridge regression coefficients, <span class="math notranslate nohighlight">\(\lambda\)</span> is the regularization
strength, and I_d is a dxd identity matrix where d is the number of features in the context data.</p>
<p><span class="math notranslate nohighlight">\(\alpha\)</span> is a factor used to adjust how conservative the estimate is.
Higher <span class="math notranslate nohighlight">\(\alpha\)</span> values promote more exploration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinUCB.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinUCB.alpha" title="Link to this definition"></a></dt>
<dd><p>The parameter to control the exploration.
Integer or float. Cannot be negative.
Default value is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinUCB.l2_lambda">
<span class="sig-name descname"><span class="pre">l2_lambda</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinUCB.l2_lambda" title="Link to this definition"></a></dt>
<dd><p>The regularization strength.
Integer or float. Cannot be negative.
Default value is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.LinUCB.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.LinUCB.scale" title="Link to this definition"></a></dt>
<dd><p>Whether to scale features to have zero mean and unit variance.
Uses StandardScaler in sklearn.preprocessing.
Default value is False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">LinUCB</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.25</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">alpha</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">l2_lambda</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.Popularity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Popularity</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.Popularity" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Randomized Popularity Learning Policy.</p>
<p>Returns a randomized popular arm for each prediction.
The probability of selection for each arm is weighted by their mean reward.
It assumes that the rewards are non-negative.</p>
<p>The probability of selection is calculated as:</p>
<div class="math notranslate nohighlight">
\[P(arm) = \frac{ \mu_i } { \Sigma{ \mu }  }\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_i\)</span> is the mean reward for that arm.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">Popularity</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.Random">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Random</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.Random" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Random Learning Policy.</p>
<p>Returns a random arm for each prediction.
The probability of selection for each arm is uniformly at random.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">Random</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.Softmax">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Softmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.Softmax" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Softmax Learning Policy.</p>
<p>This policy selects each arm with a probability proportionate to its average reward.
The average reward is calculated as a logistic function with each probability as:</p>
<div class="math notranslate nohighlight">
\[P(arm) = \frac{ e ^  \frac{\mu_i - \max{\mu}}{ \tau } }
{ \Sigma{e ^  \frac{\mu - \max{\mu}}{ \tau }}  }\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_i\)</span> is the mean reward for that arm and <span class="math notranslate nohighlight">\(\tau\)</span> is the “temperature” to determine
the degree of exploration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.Softmax.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.Softmax.tau" title="Link to this definition"></a></dt>
<dd><p>The temperature to control the exploration.
Integer or float. Must be greater than zero.
Default value is 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">tau</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.ThompsonSampling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ThompsonSampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binarizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.ThompsonSampling" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Thompson Sampling Learning Policy.</p>
<p>This policy creates a beta distribution for each arm and
then randomly samples from these distributions.
The arm with the highest sample value is selected.</p>
<p>Notice that rewards must be binary to create beta distributions.
If rewards are not binary, see the <code class="docutils literal notranslate"><span class="pre">binarizer</span></code> function.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.ThompsonSampling.binarizer">
<span class="sig-name descname"><span class="pre">binarizer</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.ThompsonSampling.binarizer" title="Link to this definition"></a></dt>
<dd><p>If rewards are not binary, a binarizer function is required.
Given an arm decision and its corresponding reward, the binarizer function
returns <cite>True/False</cite> or <cite>0/1</cite> to denote whether the decision counts
as a success, i.e., <cite>True/1</cite> based on the reward or <cite>False/0</cite> otherwise.</p>
<p>The function signature of the binarizer is:</p>
<p><code class="docutils literal notranslate"><span class="pre">binarize(arm:</span> <span class="pre">Arm,</span> <span class="pre">reward:</span> <span class="pre">Num)</span> <span class="pre">-&gt;</span> <span class="pre">True/False</span> <span class="pre">or</span> <span class="pre">0/1</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">ThompsonSampling</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arm_to_threshold</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Arm1&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">binarize</span><span class="p">(</span><span class="n">arm</span><span class="p">,</span> <span class="n">reward</span><span class="p">):</span> <span class="k">return</span> <span class="n">reward</span> <span class="o">&gt;</span> <span class="n">arm_to_threshold</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">ThompsonSampling</span><span class="p">(</span><span class="n">binarizer</span><span class="o">=</span><span class="n">binarize</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">binarizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.UCB1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UCB1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.UCB1" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Upper Confidence Bound1 Learning Policy.</p>
<p>This policy calculates an upper confidence bound for the mean reward of each arm.
It greedily selects the arm with the highest upper confidence bound.</p>
<p>The UCB for each arm is calculated as:</p>
<div class="math notranslate nohighlight">
\[UCB = \mu_i + \alpha \times \sqrt[]{\frac{2 \times log(N)}{n_i}}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mu_i\)</span> is the mean for that arm,
<span class="math notranslate nohighlight">\(N\)</span> is the total number of trials, and
<span class="math notranslate nohighlight">\(n_i\)</span> is the number of times the arm has been selected.</p>
<p><span class="math notranslate nohighlight">\(\alpha\)</span> is a factor used to adjust how conservative the estimate is.
Higher <span class="math notranslate nohighlight">\(\alpha\)</span> values promote more exploration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.LearningPolicy.UCB1.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#mabwiser.mab.LearningPolicy.UCB1.alpha" title="Link to this definition"></a></dt>
<dd><p>The parameter to control the exploration.
Integer of float. Cannot be negative.
Default value is 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">UCB1</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.25</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">alpha</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.MAB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mabwiser.mab.</span></span><span class="sig-name descname"><span class="pre">MAB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LearningPolicyType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NeighborhoodPolicyType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">123456</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.MAB" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p><strong>MABWiser: Contextual Multi-Armed Bandit Library</strong></p>
<p>MABWiser is a research library for fast prototyping of multi-armed bandit algorithms.
It supports <strong>context-free</strong>, <strong>parametric</strong> and <strong>non-parametric</strong> <strong>contextual</strong> bandit models.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.arms">
<span class="sig-name descname"><span class="pre">arms</span></span><a class="headerlink" href="#mabwiser.mab.MAB.arms" title="Link to this definition"></a></dt>
<dd><p>The list of all the arms available for decisions. Arms can be integers, strings, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.learning_policy">
<span class="sig-name descname"><span class="pre">learning_policy</span></span><a class="headerlink" href="#mabwiser.mab.MAB.learning_policy" title="Link to this definition"></a></dt>
<dd><p>The learning policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>LearningPolicyType</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.neighborhood_policy">
<span class="sig-name descname"><span class="pre">neighborhood_policy</span></span><a class="headerlink" href="#mabwiser.mab.MAB.neighborhood_policy" title="Link to this definition"></a></dt>
<dd><p>The neighborhood policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>NeighborhoodPolicyType</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.is_contextual">
<span class="sig-name descname"><span class="pre">is_contextual</span></span><a class="headerlink" href="#mabwiser.mab.MAB.is_contextual" title="Link to this definition"></a></dt>
<dd><p>True if contextual policy is given, false otherwise. This is a read-only data field.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#mabwiser.mab.MAB.seed" title="Link to this definition"></a></dt>
<dd><p>The random seed to initialize the internal random number generator. This is a read-only data field.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numbers.Rational</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.n_jobs">
<span class="sig-name descname"><span class="pre">n_jobs</span></span><a class="headerlink" href="#mabwiser.mab.MAB.n_jobs" title="Link to this definition"></a></dt>
<dd><p>This is used to specify how many concurrent processes/threads should be used for parallelized routines.
Default value is set to 1.
If set to -1, all CPUs are used.
If set to -2, all CPUs but one are used, and so on.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.backend">
<span class="sig-name descname"><span class="pre">backend</span></span><a class="headerlink" href="#mabwiser.mab.MAB.backend" title="Link to this definition"></a></dt>
<dd><p>Specify a parallelization backend implementation supported in the joblib library. Supported options are:
- “loky” used by default, can induce some communication and memory overhead when exchanging input and</p>
<blockquote>
<div><p>output data with the worker Python processes.</p>
</div></blockquote>
<ul class="simple">
<li><p>“multiprocessing” previous process-based backend based on multiprocessing.Pool. Less robust than loky.</p></li>
<li><p>“threading” is a very low-overhead backend but, it suffers from the Python Global Interpreter Lock if the
called function relies a lot on Python objects.</p></li>
</ul>
<p>Default value is None. In this case the default backend selected by joblib will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">add_arm</span><span class="p">(</span><span class="s1">&#39;Arm3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">([</span><span class="s1">&#39;Arm3&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="go">&#39;Arm3&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(),</span> <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">KNearest</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="go">[&#39;Arm2&#39;, &#39;Arm2&#39;, &#39;Arm2&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">add_arm</span><span class="p">(</span><span class="s1">&#39;Arm3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">([</span><span class="s1">&#39;Arm3&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contextual_mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">&#39;Arm3&#39;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.add_arm">
<span class="sig-name descname"><span class="pre">add_arm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">binarizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.mab.MAB.add_arm" title="Link to this definition"></a></dt>
<dd><p>Adds an _arm_ to the list of arms.</p>
<p>Incorporates the arm into the learning and neighborhood policies with no training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arm</strong> (<a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><em>Arm</em></a>) – The new arm to be added.</p></li>
<li><p><strong>binarizer</strong> (<em>Callable</em>) – The new binarizer function for Thompson Sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>No return.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – For ThompsonSampling, binarizer must be a callable function.:</p></li>
<li><p><strong>ValueError</strong> – A binarizer function was provided but the learning policy is not Thompson Sampling.:</p></li>
<li><p><strong>ValueError</strong> – The arm already exists.:</p></li>
<li><p><strong>ValueError</strong> – The arm is <code class="docutils literal notranslate"><span class="pre">None</span></code>.:</p></li>
<li><p><strong>ValueError</strong> – The arm is <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.:</p></li>
<li><p><strong>ValueError</strong> – The arm is <code class="docutils literal notranslate"><span class="pre">Infinity</span></code>.:</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.cold_arms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cold_arms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mabwiser.mab.MAB.cold_arms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decisions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contexts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.mab.MAB.fit" title="Link to this definition"></a></dt>
<dd><p>Fits the multi-armed bandit to the given <em>decisions</em>, their corresponding <em>rewards</em>
and <em>contexts</em>, if any.</p>
<p>Validates arguments and raises exceptions in case there are violations.</p>
<dl class="simple">
<dt>This function makes the following assumptions:</dt><dd><ul class="simple">
<li><p>each decision corresponds to an arm of the bandit.</p></li>
<li><p>there are no <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">Nan</span></code>, or <code class="docutils literal notranslate"><span class="pre">Infinity</span></code> values in the contexts.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decisions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><em>Arm</em></a><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>]</em>) – The decisions that are made.</p></li>
<li><p><strong>rewards</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>]</em>) – The rewards that are received corresponding to the decisions.</p></li>
<li><p><strong>contexts</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>List</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The context under which each decision is made. Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>, i.e., no contexts.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>No return.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – Decisions and rewards are not given as list, numpy array or pandas series.:</p></li>
<li><p><strong>TypeError</strong> – Contexts is not given as <code class="docutils literal notranslate"><span class="pre">None</span></code>, list, numpy array, pandas series or data frames.:</p></li>
<li><p><strong>ValueError</strong> – Length mismatch between decisions, rewards, and contexts.:</p></li>
<li><p><strong>ValueError</strong> – Fitting contexts data when there is no contextual policy.:</p></li>
<li><p><strong>ValueError</strong> – Contextual policy when fitting no contexts data.:</p></li>
<li><p><strong>ValueError</strong> – Rewards contain <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">Nan</span></code>, or <code class="docutils literal notranslate"><span class="pre">Infinity</span></code>.:</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id13">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learning_policy</span></span><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd><p>Creates named tuple of the learning policy based on the implementor.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The learning policy.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – MAB learning_policy property not implemented for this learning policy.:</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id14">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">neighborhood_policy</span></span><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd><p>Creates named tuple of the neighborhood policy based on the implementor.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The neighborhood policy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.partial_fit">
<span class="sig-name descname"><span class="pre">partial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decisions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contexts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.mab.MAB.partial_fit" title="Link to this definition"></a></dt>
<dd><p>Updates the multi-armed bandit with the given <em>decisions</em>, their corresponding <em>rewards</em>
and <em>contexts</em>, if any.</p>
<p>Validates arguments and raises exceptions in case there are violations.</p>
<dl class="simple">
<dt>This function makes the following assumptions:</dt><dd><ul class="simple">
<li><p>each decision corresponds to an arm of the bandit.</p></li>
<li><p>there are no <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">Nan</span></code>, or <code class="docutils literal notranslate"><span class="pre">Infinity</span></code> values in the contexts.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decisions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><em>Arm</em></a><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>]</em>) – The decisions that are made.</p></li>
<li><p><strong>rewards</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>]</em>) – The rewards that are received corresponding to the decisions.</p></li>
<li><p><strong>contexts</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>List</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>] </em><em>=</em>) – The context under which each decision is made. Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>, i.e., no contexts.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>No return.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – Decisions, rewards are not given as list, numpy array or pandas series.:</p></li>
<li><p><strong>TypeError</strong> – Contexts is not given as <code class="docutils literal notranslate"><span class="pre">None</span></code>, list, numpy array, pandas series or data frames.:</p></li>
<li><p><strong>ValueError</strong> – Length mismatch between decisions, rewards, and contexts.:</p></li>
<li><p><strong>ValueError</strong> – Fitting contexts data when there is no contextual policy.:</p></li>
<li><p><strong>ValueError</strong> – Contextual policy when fitting no contexts data.:</p></li>
<li><p><strong>ValueError</strong> – Rewards contain <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">Nan</span></code>, or <code class="docutils literal notranslate"><span class="pre">Infinity</span></code>:</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contexts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mabwiser.mab.MAB.predict" title="Link to this definition"></a></dt>
<dd><p>Returns the “best” arm (or arms list if multiple contexts are given) based on the expected reward.</p>
<p>The definition of the <em>best</em> depends on the specified learning policy.
Contextual learning policies and neighborhood policies require contexts data in training.
In testing, they return the best arm given new context(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>contexts</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>List</em><em>[</em><em>Num</em><em>]</em><em>, </em><em>List</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The context for the expected rewards. Default value is None.
If contexts is not <code class="docutils literal notranslate"><span class="pre">None</span></code> for context-free bandits, the predictions returned will be a
list of the same length as contexts.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The recommended arm or recommended arms list.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – Contexts is not given as <code class="docutils literal notranslate"><span class="pre">None</span></code>, list, numpy array, pandas series or data frames.:</p></li>
<li><p><strong>ValueError</strong> – Prediction with context policy requires context data.:</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.predict_expectations">
<span class="sig-name descname"><span class="pre">predict_expectations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contexts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mabwiser.mab.MAB.predict_expectations" title="Link to this definition"></a></dt>
<dd><p>Returns a dictionary of arms (key) to their expected rewards (value).</p>
<p>Contextual learning policies and neighborhood policies require contexts data for expected rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>contexts</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>List</em><em>[</em><em>Num</em><em>]</em><em>, </em><em>List</em><em>[</em><em>List</em><em>[</em><em>Num</em><em>]</em><em>]</em><em>, </em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The context for the expected rewards. Default value is None.
If contexts is not <code class="docutils literal notranslate"><span class="pre">None</span></code> for context-free bandits, the predicted expectations returned will be a
list of the same length as contexts.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The dictionary of arms (key) to their expected rewards (value), or a list of such dictionaries.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – Contexts is not given as <code class="docutils literal notranslate"><span class="pre">None</span></code>, list, numpy array or pandas data frames.:</p></li>
<li><p><strong>ValueError</strong> – Prediction with context policy requires context data.:</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.remove_arm">
<span class="sig-name descname"><span class="pre">remove_arm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.mab.MAB.remove_arm" title="Link to this definition"></a></dt>
<dd><p>Removes an _arm_ from the list of arms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arm</strong> (<a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><em>Arm</em></a>) – The existing arm to be removed.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>No return.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – The arm does not exist.:</p></li>
<li><p><strong>ValueError</strong> – The arm is <code class="docutils literal notranslate"><span class="pre">None</span></code>.:</p></li>
<li><p><strong>ValueError</strong> – The arm is <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.:</p></li>
<li><p><strong>ValueError</strong> – The arm is <code class="docutils literal notranslate"><span class="pre">Infinity</span></code>.:</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.mab.MAB.warm_start">
<span class="sig-name descname"><span class="pre">warm_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arm_to_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.mab.MAB.warm_start" title="Link to this definition"></a></dt>
<dd><p>Warm-start untrained (cold) arms of the multi-armed bandit.</p>
<p>Validates arguments and raises exceptions in case there are violations.</p>
<p>The warm-start procedure depends on the learning and neighborhood policy. Note that for certain neighborhood
policies (e.g., LSHNearest, KNearest, Radius) warm start can only be performed after the nearest neighbors
have been determined in the “predict” step. Accordingly, warm start has to be executed for each context being
predicted which is computationally expensive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arm_to_features</strong> (<em>Dict</em><em>[</em><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><em>Arm</em></a><em>, </em><em>List</em><em>[</em><em>Num</em><em>]</em><em>]</em>) – Numeric representation for each arm.</p></li>
<li><p><strong>distance_quantile</strong> (<em>float</em>) – Value between 0 and 1 used to determine if an item can be warm started or not using closest item.
All cold items will be warm started if 1 and none will be warm started if 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>No return.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – Arm features are not given as a dictionary.:</p></li>
<li><p><strong>TypeError</strong> – Distance quantile is not given as a float.:</p></li>
<li><p><strong>ValueError</strong> – Distance quantile is not between 0 and 1.:</p></li>
<li><p><strong>ValueError</strong> – The arms in arm_to_features do not match arms.:</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mabwiser.mab.</span></span><span class="sig-name descname"><span class="pre">NeighborhoodPolicy</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.Clusters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_minibatch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Clusters" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Clusters Neighborhood Policy.</p>
<p>Clusters is a k-means clustering approach that uses the observations
from the closest <em>cluster</em> with a learning policy.
Supports <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> and <code class="docutils literal notranslate"><span class="pre">MiniBatchKMeans</span></code>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.Clusters.n_clusters">
<span class="sig-name descname"><span class="pre">n_clusters</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Clusters.n_clusters" title="Link to this definition"></a></dt>
<dd><p>The number of clusters. Integer. Must be at least 2. Default value is 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.Clusters.is_minibatch">
<span class="sig-name descname"><span class="pre">is_minibatch</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Clusters.is_minibatch" title="Link to this definition"></a></dt>
<dd><p>Boolean flag to use <code class="docutils literal notranslate"><span class="pre">MiniBatchKMeans</span></code> or not. Default value is False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>                             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">Clusters</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">[3, 1]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">is_minibatch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">n_clusters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.KNearest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">KNearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.KNearest" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>KNearest Neighborhood Policy.</p>
<p>KNearest is a nearest neighbors approach that selects the <em>k-nearest</em> observations
to be used with a learning policy.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.KNearest.k">
<span class="sig-name descname"><span class="pre">k</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.KNearest.k" title="Link to this definition"></a></dt>
<dd><p>The number of neighbors to select.
Integer value. Must be greater than zero.
Default value is 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.KNearest.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.KNearest.metric" title="Link to this definition"></a></dt>
<dd><p>The metric used to calculate distance.
Accepts any of the metrics supported by <code class="docutils literal notranslate"><span class="pre">scipy.spatial.distance.cdist</span></code>.
Default value is Euclidean distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>                             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>                           <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">KNearest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;euclidean&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.LSHNearest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LSHNearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_tables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_nhood_prob_of_arm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.LSHNearest" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Locality-Sensitive Hashing Approximate Nearest Neighbors Policy.</p>
<p>LSHNearest is a nearest neighbors approach that uses locality sensitive hashing with a simhash to
select observations to be used with a learning policy.</p>
<p>For the simhash, contexts are projected onto a hyperplane of n_context_cols x n_dimensions and each
column of the hyperplane is evaluated for its sign, giving an ordered array of binary values.
This is converted to a base 10 integer used as the hash code to assign the context to a hash table. This
process is repeated for a specified number of hash tables, where each has a unique, randomly-generated
hyperplane. To select the neighbors for a context, the hash code is calculated for each hash table and any
contexts with the same hashes are selected as the neighbors.</p>
<p>As with the radius or k value for other nearest neighbors algorithms, selecting the best number of dimensions
and tables requires tuning. For the dimensions, a good starting point is to use the log of the square root of
the number of rows in the training data. This will give you sqrt(n_rows) number of hashes.</p>
<p>The number of dimensions and number of tables have inverse effects from each other on the number of empty
neighborhoods and average neighborhood size. Increasing the dimensionality decreases the number of collisions,
which increases the precision of the approximate neighborhood but also potentially increases the number of empty
neighborhoods. Increasing the number of hash tables increases the likelihood of capturing neighbors the
other random hyperplanes miss and increases the average neighborhood size. It should be noted that the fit
operation is O(2**n_dimensions).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.LSHNearest.n_dimensions">
<span class="sig-name descname"><span class="pre">n_dimensions</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.LSHNearest.n_dimensions" title="Link to this definition"></a></dt>
<dd><p>The number of dimensions to use for the hyperplane.
Integer value. Must be greater than zero.
Default value is 5.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.LSHNearest.n_tables">
<span class="sig-name descname"><span class="pre">n_tables</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.LSHNearest.n_tables" title="Link to this definition"></a></dt>
<dd><p>The number of hash tables.
Integer value. Must be greater than zero.
Default value is 3.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.LSHNearest.no_nhood_prob_of_arm">
<span class="sig-name descname"><span class="pre">no_nhood_prob_of_arm</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.LSHNearest.no_nhood_prob_of_arm" title="Link to this definition"></a></dt>
<dd><p>The probabilities associated with each arm. Used to select random arm if context has no neighbors.
If not given, a uniform random distribution over all arms is assumed.
The probabilities should sum up to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or List</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>                             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>                           <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">LSHNearest</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">[3, 1]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">n_dimensions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">n_tables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">no_nhood_prob_of_arm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.Radius">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_nhood_prob_of_arm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Radius" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Radius Neighborhood Policy.</p>
<p>Radius is a nearest neighborhood approach that selects the observations
within a given <em>radius</em> to be used with a learning policy.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.Radius.radius">
<span class="sig-name descname"><span class="pre">radius</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Radius.radius" title="Link to this definition"></a></dt>
<dd><p>The maximum distance within which to select observations.
Integer or Float. Must be greater than zero.
Default value is 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Num</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.Radius.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Radius.metric" title="Link to this definition"></a></dt>
<dd><p>The metric used to calculate distance.
Accepts any of the metrics supported by scipy.spatial.distance.cdist.
Default value is Euclidean distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.Radius.no_nhood_prob_of_arm">
<span class="sig-name descname"><span class="pre">no_nhood_prob_of_arm</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.Radius.no_nhood_prob_of_arm" title="Link to this definition"></a></dt>
<dd><p>The probabilities associated with each arm. Used to select random arm if context has no neighbors.
If not given, a uniform random distribution over all arms is assumed.
The probabilities should sum up to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or List</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>                             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>                           <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">Radius</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;euclidean&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">[3, 1]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">no_nhood_prob_of_arm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">radius</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.TreeBandit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TreeBandit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.TreeBandit" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>TreeBandit Neighborhood Policy.</p>
<p>This policy fits a decision tree for each arm using context history.
It uses the leaves of these trees to partition the context space into regions
and keeps a list of rewards for each leaf.
To predict, it receives a context vector and goes to the corresponding
leaf at each arm’s tree and applies the given context-free MAB learning policy
to predict expectations and choose an arm.</p>
<p>The TreeBandit neighborhood policy is compatible with the following
context-free learning policies only: EpsilonGreedy, ThompsonSampling and UCB1.</p>
<p>The TreeBandit neighborhood policy is a modified version of
the TreeHeuristic algorithm presented in:
Adam N. Elmachtoub, Ryan McNellis, Sechan Oh, Marek Petrik
A Practical Method for Solving Contextual Bandit Problems Using Decision Trees, UAI 2017</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.mab.NeighborhoodPolicy.TreeBandit.tree_parameters">
<span class="sig-name descname"><span class="pre">tree_parameters</span></span><a class="headerlink" href="#mabwiser.mab.NeighborhoodPolicy.TreeBandit.tree_parameters" title="Link to this definition"></a></dt>
<dd><p>Parameters of the decision tree.
The keys must match the parameters of sklearn.tree.DecisionTreeRegressor.
When a parameter is not given, the default parameters from
sklearn.tree.DecisionTreeRegressor will be chosen.
Default value is an empty dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict, <a href="#id25"><span class="problematic" id="id26">**</span></a>kwarg</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="p">,</span> <span class="n">NeighborhoodPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contexts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">list_of_arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">NeighborhoodPolicy</span><span class="o">.</span><span class="n">TreeBandit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">contexts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">&#39;Arm2&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">tree_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#id27" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

</dd></dl>

</section>
<section id="module-mabwiser.simulator">
<span id="simulator"></span><h2>simulator<a class="headerlink" href="#module-mabwiser.simulator" title="Link to this heading"></a></h2>
<p>This module provides a simulation utility for comparing algorithms and hyper-parameter tuning.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mabwiser.simulator.</span></span><span class="sig-name descname"><span class="pre">Simulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">bandits:</span> <span class="pre">~typing.List[tuple],</span> <span class="pre">decisions:</span> <span class="pre">~typing.List[Arm]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">~pandas.core.series.Series,</span> <span class="pre">rewards:</span> <span class="pre">~typing.List[int</span> <span class="pre">|</span> <span class="pre">float]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">~pandas.core.series.Series,</span> <span class="pre">contexts:</span> <span class="pre">None</span> <span class="pre">|</span> <span class="pre">~typing.List[~typing.List[int</span> <span class="pre">|</span> <span class="pre">float]]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">~pandas.core.series.Series</span> <span class="pre">|</span> <span class="pre">~pandas.core.frame.DataFrame</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">scaler:</span> <span class="pre">callable</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">test_size:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.3,</span> <span class="pre">is_ordered:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">batch_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">evaluator:</span> <span class="pre">callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">default_evaluator&gt;,</span> <span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">123456,</span> <span class="pre">is_quick:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">log_file:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">log_format:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'%(asctime)s</span> <span class="pre">%(levelname)s</span> <span class="pre">%(message)s'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mabwiser.simulator.Simulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Multi-Armed Bandit Simulator.</p>
<p>This utility runs a simulation using historic data and a collection of multi-armed bandits from the MABWiser
library or that extends the BaseMAB class in MABWiser.</p>
<p>It can be used to run a simple simulation with a single bandit or to compare multiple bandits for policy selection,
hyper-parameter tuning, etc.</p>
<p>Nearest Neighbor bandits that use the default Radius and KNearest implementations from MABWiser are converted to
custom versions that share distance calculations to speed up the simulation. These custom versions also track
statistics about the neighborhoods that can be used in evaluation.</p>
<p>The results can be accessed as the arms_to_stats, model_to_predictions, model_to_confusion_matrices, and
models_to_evaluations properties.</p>
<p>When using partial fitting, an additional confusion matrix is calculated for all predictions after all of the
batches are processed.</p>
<p>A log of the simulation tracks the experiment progress.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.bandits">
<span class="sig-name descname"><span class="pre">bandits</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.bandits" title="Link to this definition"></a></dt>
<dd><p>A list of tuples of the name of each bandit and the bandit object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[(str, bandit)]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.decisions">
<span class="sig-name descname"><span class="pre">decisions</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.decisions" title="Link to this definition"></a></dt>
<dd><p>The complete decision history to be used in train and test.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.rewards">
<span class="sig-name descname"><span class="pre">rewards</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.rewards" title="Link to this definition"></a></dt>
<dd><p>The complete array history to be used in train and test.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.contexts">
<span class="sig-name descname"><span class="pre">contexts</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.contexts" title="Link to this definition"></a></dt>
<dd><p>The complete context history to be used in train and test.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.scaler">
<span class="sig-name descname"><span class="pre">scaler</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.scaler" title="Link to this definition"></a></dt>
<dd><p>A scaler object from sklearn.preprocessing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scaler</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.test_size">
<span class="sig-name descname"><span class="pre">test_size</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.test_size" title="Link to this definition"></a></dt>
<dd><p>The size of the test set</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.is_ordered">
<span class="sig-name descname"><span class="pre">is_ordered</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.is_ordered" title="Link to this definition"></a></dt>
<dd><p>Whether to use a chronological division for the train-test split.
If false, uses sklearn’s train_test_split.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.batch_size" title="Link to this definition"></a></dt>
<dd><p>The size of each batch for online learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.evaluator">
<span class="sig-name descname"><span class="pre">evaluator</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.evaluator" title="Link to this definition"></a></dt>
<dd><p>The function for evaluating the bandits. Values are stored in bandit_to_arm_to_stats_avg.
Must have the function signature function(arms_to_stats_train: dictionary, predictions: list,
decisions: np.ndarray, rewards: np.ndarray, metric: str).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.is_quick">
<span class="sig-name descname"><span class="pre">is_quick</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.is_quick" title="Link to this definition"></a></dt>
<dd><p>Flag to skip neighborhood statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.logger" title="Link to this definition"></a></dt>
<dd><p>The logger object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.arms">
<span class="sig-name descname"><span class="pre">arms</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.arms" title="Link to this definition"></a></dt>
<dd><p>The list of arms used by the bandits.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.arm_to_stats_total">
<span class="sig-name descname"><span class="pre">arm_to_stats_total</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.arm_to_stats_total" title="Link to this definition"></a></dt>
<dd><p>Descriptive statistics for the complete data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.arm_to_stats_train">
<span class="sig-name descname"><span class="pre">arm_to_stats_train</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.arm_to_stats_train" title="Link to this definition"></a></dt>
<dd><p>Descriptive statistics for the training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.arm_to_stats_test">
<span class="sig-name descname"><span class="pre">arm_to_stats_test</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.arm_to_stats_test" title="Link to this definition"></a></dt>
<dd><p>Descriptive statistics for the test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.bandit_to_arm_to_stats_avg">
<span class="sig-name descname"><span class="pre">bandit_to_arm_to_stats_avg</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_avg" title="Link to this definition"></a></dt>
<dd><p>Descriptive statistics for the predictions made by each bandit based on means from training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.bandit_to_arm_to_stats_min">
<span class="sig-name descname"><span class="pre">bandit_to_arm_to_stats_min</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_min" title="Link to this definition"></a></dt>
<dd><p>Descriptive statistics for the predictions made by each bandit based on minimums from training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.bandit_to_arm_to_stats_max">
<span class="sig-name descname"><span class="pre">bandit_to_arm_to_stats_max</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_max" title="Link to this definition"></a></dt>
<dd><p>Descriptive statistics for the predictions made by each bandit based on maximums from training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.bandit_to_confusion_matrices">
<span class="sig-name descname"><span class="pre">bandit_to_confusion_matrices</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_confusion_matrices" title="Link to this definition"></a></dt>
<dd><p>The confusion matrices for each bandit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.bandit_to_predictions">
<span class="sig-name descname"><span class="pre">bandit_to_predictions</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_predictions" title="Link to this definition"></a></dt>
<dd><p>The prediction for each item in the test set for each bandit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.bandit_to_expectations">
<span class="sig-name descname"><span class="pre">bandit_to_expectations</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_expectations" title="Link to this definition"></a></dt>
<dd><p>The arm_to_expectations for each item in the test set for each bandit.
For context-free bandits, there is a single dictionary for each batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.bandit_to_neighborhood_size">
<span class="sig-name descname"><span class="pre">bandit_to_neighborhood_size</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_neighborhood_size" title="Link to this definition"></a></dt>
<dd><p>The number of neighbors in each neighborhood for each row in the test set.
Calculated when using a Radius neighborhood policy, or a custom class that inherits from it.
Not calculated when is_quick is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.bandit_to_arm_to_stats_neighborhoods">
<span class="sig-name descname"><span class="pre">bandit_to_arm_to_stats_neighborhoods</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.bandit_to_arm_to_stats_neighborhoods" title="Link to this definition"></a></dt>
<dd><p>The arm_to_stats for each neighborhood for each row in the test set.
Calculated when using Radius or KNearest, or a custom class that inherits from one of them.
Not calculated when is_quick is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.test_indices">
<span class="sig-name descname"><span class="pre">test_indices</span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.test_indices" title="Link to this definition"></a></dt>
<dd><p>The indices of the rows in the test set.
If input was not zero-indexed, these will reflect their position in the input rather than actual index.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mabwiser.mab</span> <span class="kn">import</span> <span class="n">MAB</span><span class="p">,</span> <span class="n">LearningPolicy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm2&#39;</span><span class="p">,</span> <span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab1</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mab2</span> <span class="o">=</span> <span class="n">MAB</span><span class="p">(</span><span class="n">arms</span><span class="p">,</span> <span class="n">LearningPolicy</span><span class="o">.</span><span class="n">EpsilonGreedy</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.30</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandits</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;EG 25%&#39;</span><span class="p">,</span> <span class="n">mab1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;EG 30%&#39;</span><span class="p">,</span> <span class="n">mab2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offline_sim</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="n">bandits</span><span class="p">,</span> <span class="n">decisions</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offline_sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offline_sim</span><span class="o">.</span><span class="n">bandit_to_arm_to_stats_avg</span><span class="p">[</span><span class="s1">&#39;EG 30%&#39;</span><span class="p">][</span><span class="s1">&#39;Arm1&#39;</span><span class="p">]</span>
<span class="go">{&#39;count&#39;: 1, &#39;sum&#39;: 9, &#39;min&#39;: 9, &#39;max&#39;: 9, &#39;mean&#39;: 9.0, &#39;std&#39;: 0.0}</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.get_arm_stats">
<span class="sig-name descname"><span class="pre">get_arm_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decisions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.get_arm_stats" title="Link to this definition"></a></dt>
<dd><p>Calculates descriptive statistics for each arm in the provided data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decisions</strong> (<em>np.ndarray</em>) – The decisions to filter the rewards.</p></li>
<li><p><strong>rewards</strong> (<em>np.ndarray</em>) – The rewards to get statistics about.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Arm_to_stats dictionary.</em></p></li>
<li><p><em>Dictionary has the format {arm {‘count’, ‘sum’, ‘min’, ‘max’, ‘mean’, ‘std’}}</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.get_stats">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.get_stats" title="Link to this definition"></a></dt>
<dd><p>Calculates descriptive statistics for the given array of rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rewards</strong> (<em>nd.nparray</em>) – Array of rewards for a single arm.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A dictionary of descriptive statistics.</em></p></li>
<li><p><em>Dictionary has the format {‘count’, ‘sum’, ‘min’, ‘max’, ‘mean’, ‘std’}</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'avg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_per_arm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.plot" title="Link to this definition"></a></dt>
<dd><p>Generates a plot of the cumulative sum of the rewards for each bandit.
Simulation must be run before calling this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<em>str</em>) – The bandit_to_arm_to_stats to use to generate the plot. Must be ‘avg’, ‘min’, or ‘max</p></li>
<li><p><strong>is_per_arm</strong> (<em>bool</em>) – Whether to plot each arm separately or use an aggregate statistic.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError  Descriptive statics for predictions are missing.</strong> – </p></li>
<li><p><strong>TypeError       Metric must be a string.</strong> – </p></li>
<li><p><strong>TypeError       The per_arm flag must be a boolean.</strong> – </p></li>
<li><p><strong>ValueError      The metric must be one</strong><strong> of </strong><strong>avg</strong><strong>, </strong><strong>min</strong><strong> or </strong><strong>max.</strong> – </p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mabwiser.simulator.Simulator.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.simulator.Simulator.run" title="Link to this definition"></a></dt>
<dd><p>Run simulator</p>
<p>Runs a simulation concurrently for all bandits in the bandits list.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mabwiser.simulator.default_evaluator">
<span class="sig-prename descclassname"><span class="pre">mabwiser.simulator.</span></span><span class="sig-name descname"><span class="pre">default_evaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decisions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arm_to_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#mabwiser.simulator.default_evaluator" title="Link to this definition"></a></dt>
<dd><p>Default evaluation function.</p>
<p>Calculates predicted rewards for the test batch based on predicted arms.
When the predicted arm is the same as the historic decision, the historic reward is used.
When the predicted arm is different, the mean, min or max reward from the training data is used.
If using Radius or KNearest neighborhood policy, the statistics from the neighborhood are used
instead of the entire training set.</p>
<p>The simulator supports custom evaluation functions,
but they must have this signature to work with the simulation pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arms</strong> (<em>list</em>) – The list of arms.</p></li>
<li><p><strong>decisions</strong> (<em>np.ndarray</em>) – The historic decisions for the batch being evaluated.</p></li>
<li><p><strong>rewards</strong> (<em>np.ndarray</em>) – The historic rewards for the batch being evaluated.</p></li>
<li><p><strong>predictions</strong> (<em>list</em>) – The predictions for the batch being evaluated.</p></li>
<li><p><strong>arm_to_stats</strong> (<em>dict</em>) – The dictionary of descriptive statistics for each arm to use in evaluation.</p></li>
<li><p><strong>stat</strong> (<em>str</em>) – Which metric from arm_to_stats to use. Takes the values ‘min’, ‘max’, ‘mean’.</p></li>
<li><p><strong>start_index</strong> (<em>int</em>) – The index of the first row in the batch.
For offline simulations it is 0.
For _online simulations it is batch size * batch number.
Used to select the correct index from arm_to_stats if there are separate entries for each row in the test set.</p></li>
<li><p><strong>nn</strong> (<em>bool</em>) – Whether the results are from one of the simulator custom nearest neighbors implementations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>An arm_to_stats dictionary for the predictions in the batch.</em></p></li>
<li><p><em>Dictionary has the format {arm {‘count’, ‘sum’, ‘min’, ‘max’, ‘mean’, ‘std’}}</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mabwiser.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-mabwiser.utils" title="Link to this heading"></a></h2>
<p>This module provides a number of constants and helper functions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.utils.Arm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mabwiser.utils.</span></span><span class="sig-name descname"><span class="pre">Arm</span></span><a class="headerlink" href="#mabwiser.utils.Arm" title="Link to this definition"></a></dt>
<dd><p>Arm type is defined as integer, float, or string.</p>
<p>alias of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mabwiser.utils.Constants">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mabwiser.utils.</span></span><span class="sig-name descname"><span class="pre">Constants</span></span><a class="headerlink" href="#mabwiser.utils.Constants" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Constant values used by the modules.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.utils.Constants.default_seed">
<span class="sig-name descname"><span class="pre">default_seed</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">123456</span></em><a class="headerlink" href="#mabwiser.utils.Constants.default_seed" title="Link to this definition"></a></dt>
<dd><p>The default random seed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mabwiser.utils.Constants.distance_metrics">
<span class="sig-name descname"><span class="pre">distance_metrics</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['braycurtis',</span> <span class="pre">'canberra',</span> <span class="pre">'chebyshev',</span> <span class="pre">'cityblock',</span> <span class="pre">'correlation',</span> <span class="pre">'cosine',</span> <span class="pre">'dice',</span> <span class="pre">'euclidean',</span> <span class="pre">'hamming',</span> <span class="pre">'jaccard',</span> <span class="pre">'kulsinski',</span> <span class="pre">'mahalanobis',</span> <span class="pre">'matching',</span> <span class="pre">'minkowski',</span> <span class="pre">'rogerstanimoto',</span> <span class="pre">'russellrao',</span> <span class="pre">'seuclidean',</span> <span class="pre">'sokalmichener',</span> <span class="pre">'sokalsneath',</span> <span class="pre">'sqeuclidean']</span></em><a class="headerlink" href="#mabwiser.utils.Constants.distance_metrics" title="Link to this definition"></a></dt>
<dd><p>The distance metrics supported by neighborhood policies.</p>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="mabwiser.utils.Num">
<span class="sig-prename descclassname"><span class="pre">mabwiser.utils.</span></span><span class="sig-name descname"><span class="pre">Num</span></span><a class="headerlink" href="#mabwiser.utils.Num" title="Link to this definition"></a></dt>
<dd><p>Num type is defined as integer or float.</p>
<p>alias of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mabwiser.utils.argmax">
<span class="sig-prename descclassname"><span class="pre">mabwiser.utils.</span></span><span class="sig-name descname"><span class="pre">argmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a></span></span><a class="headerlink" href="#mabwiser.utils.argmax" title="Link to this definition"></a></dt>
<dd><p>Returns the first key with the maximum value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mabwiser.utils.argmin">
<span class="sig-prename descclassname"><span class="pre">mabwiser.utils.</span></span><span class="sig-name descname"><span class="pre">argmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mabwiser.utils.Arm" title="mabwiser.utils.Arm"><span class="pre">Arm</span></a></span></span><a class="headerlink" href="#mabwiser.utils.argmin" title="Link to this definition"></a></dt>
<dd><p>Returns the first key that has the minimum value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mabwiser.utils.check_false">
<span class="sig-prename descclassname"><span class="pre">mabwiser.utils.</span></span><span class="sig-name descname"><span class="pre">check_false</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Exception</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.utils.check_false" title="Link to this definition"></a></dt>
<dd><p>Checks that given expression is false, otherwise raises the given exception.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mabwiser.utils.check_true">
<span class="sig-prename descclassname"><span class="pre">mabwiser.utils.</span></span><span class="sig-name descname"><span class="pre">check_true</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Exception</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.utils.check_true" title="Link to this definition"></a></dt>
<dd><p>Checks that given expression is true, otherwise raises the given exception.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mabwiser.utils.create_rng">
<span class="sig-prename descclassname"><span class="pre">mabwiser.utils.</span></span><span class="sig-name descname"><span class="pre">create_rng</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">_BaseRNG</span></span></span><a class="headerlink" href="#mabwiser.utils.create_rng" title="Link to this definition"></a></dt>
<dd><p>Returns an rng object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>int</em>) – the seed of the rng</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – An rng object that implements the base rng class</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>_BaseRNG</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mabwiser.utils.reset">
<span class="sig-prename descclassname"><span class="pre">mabwiser.utils.</span></span><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mabwiser.utils.reset" title="Link to this definition"></a></dt>
<dd><p>Maps every key to the given value.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="new_bandit.html" class="btn btn-neutral float-left" title="Adding a New Bandit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (C), FMR LLC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>